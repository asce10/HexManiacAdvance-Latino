using HavenSoft.HexManiac.Core;
using HavenSoft.HexManiac.Core.Models;
using HavenSoft.HexManiac.Core.Models.Runs;
using HavenSoft.HexManiac.Core.Models.Runs.Sprites;
using HavenSoft.HexManiac.Core.ViewModels;
using HavenSoft.HexManiac.Core.ViewModels.Tools;
using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Xunit;

namespace HavenSoft.HexManiac.Tests {
   public class ImageImportTests {
      // first-person-view / 0
      private readonly static string
         tileset1 = "10 A0 30 00 32 00 00 F0 01 90 01 33 33 D0 01 53 05 55 33 33 55 55 00 06 55 00 02 CF 00 0B B0 01 55 35 10 19 70 01 F0 1F 20 3D BF 00 03 55 10 03 E0 1F 10 22 10 64 50 08 40 72 F0 90 52 30 57 00 13 10 1A 23 22 22 22 6D 25 00 03 00 57 22 40 53 00 03 35 20 67 FF 10 01 00 1A A0 01 10 11 90 03 F0 01 F0 01 F0 01 28 22 32 80 0B 99 60 14 32 23 22 00 23 33 32 22 32 23 23 22 00 33 32 33 22 32 33 33 13 00 99 99 99 EE 99 19 11 EE 28 92 99 20 03 E1 40 03 11 92 11 67 11 00 01 00 0C EE EE F0 01 40 01 F0 1C 9F F0 01 44 44 F0 01 90 01 F1 39 01 B7 01 1E 01 3D D3 DD 53 D4 4D 44 F1 59 B3 00 01 35 10 03 00 19 D3 3D F0 1E 40 21 00 D3 55 55 DD 4D 55 33 45 74 44 11 84 31 D3 00 36 35 00 59 DD 3D 00 55 DD 88 D8 33 84 88 88 5D DD 00 03 D8 A2 39 20 27 32 20 3D 00 03 7F D4 22 09 E2 3C 30 4B 30 03 00 1F 01 A7 01 E4 FF 20 03 21 B3 52 23 30 9B D1 98 12 0F 11 D6 50 33 C3 00 04 01 9F 12 29 22 22 00 02 20 03 C8 B0 01 01 9F 11 92 00 04 22 92 92 D9 11 C7 10 03 92 80 1E 01 A6 EE EE 11 A5 9A 01 B2 11 99 01 C8 30 03 99 10 03 19 FA 10 03 91 8B 11 AE 50 03 81 9F 34 51 8B D4 0A DD DD DD DD 00 B3 5D 02 DD 5D 80 00 A4 5D 22 99 29 D3 DD 5D 04 55 34 45 D4 33 00 1E DD DD 80 11 AF 4D 44 44 33 D5 44 44 40 32 00 08 32 53 4D 44 35 DD 15 4D 44 D3 B1 D2 74 40 03 7D 00 03 40 78 01 63 48 88 88 88 4D 87 02 88 88 44 87 88 D8 00 03 48 80 10 07 DD 88 88 58 33 88 88 02 5D 22 44 DD 33 53 00 5A 3D D7 10 7D 10 80 44 00 80 DD 53 38 00 F8 21 63 D0 00 03 00 26 55 00 9D 33 D5 4D D4 C7 00 04 10 7F 44 44 22 00 7F E2 3B 10 BF AD 00 03 54 00 03 34 51 9F 31 93 23 13 72 AF 01 C2 23 83 E3 35 F3 3A 43 2B 21 CF 20 85 F8 F0 01 53 AB F0 12 D0 01 11 BA E1 22 99 33 19 E1 01 A9 10 03 EE 22 13 6B 00 03 9D 01 AF EE 19 11 BC F0 01 10 01 1E 01 A5 3D 11 EE 01 D3 D0 18 91 C3 10 03 5D 00 61 4A 3D 30 03 22 58 00 AD D8 00 DB D8 AE 01 00 D8 01 2C 88 01 AB 11 23 10 03 32 36 D3 4D 21 B7 11 BF D5 00 03 00 02 D4 A8 01 9F 8D 00 06 78 00 06 88 44 D4 88 01 A0 8D 88 88 00 06 88 8D 78 88 01 AD 77 88 78 00 06 78 88 88 20 35 92 00 03 22 88 D8 5D 33 0A 88 48 D4 35 01 BE DD 00 03 44 BF 10 5B 88 00 40 00 DF 20 01 10 E9 11 0F 11 BB 70 44 00 7F 21 CB 00 1F 29 53 D5 44 40 22 01 E2 22 92 32 4D 22 99 10 39 D5 23 02 52 33 99 32 D5 00 35 23 53 4D 5D 85 88 88 DC 11 A3 50 03 D4 01 92 02 65 02 0F 84 3D DF 13 9B 00 8A 88 93 6B A5 5F 42 13 F5 9E 70 01 FE 11 EF A3 6F 55 5F 53 AB 31 DD 03 53 13 5B 92 6B 19 13 6D 00 0A 19 00 06 91 00 CE 13 3F 70 91 01 A3 20 01 80 07 19 91 91 91 07 91 19 19 19 99 00 06 01 C6 10 19 EF 00 03 10 29 03 7B 91 63 83 30 03 61 AB 11 D1 FA 00 08 11 D0 93 7F 21 47 00 03 87 01 53 77 40 D8 40 03 87 4D D4 77 77 D8 30 8D 77 01 83 01 9B 78 44 D4 68 00 76 44 8D 66 77 D4 68 66 49 77 00 06 77 78 00 03 67 76 30 03 01 77 88 77 87 87 77 77 00 02 20 77 D7 00 03 D8 77 77 66 53 00 77 66 2A 32 67 A6 29 32 0F 67 9A 99 32 00 5A 60 01 10 0B 11 94 C3 02 06 22 03 D5 4D 74 67 53 FA 00 19 00 6D 44 D4 67 66 44 74 77 34 66 44 00 57 00 62 87 00 06 88 DD A0 00 07 6D 00 07 76 77 87 88 76 C6 22 16 11 97 D8 4D 88 03 F7 00 AA 44 FC 11 A3 30 01 02 6F 00 5C 21 F4 80 01 88 D8 B6 13 B7 53 03 AD 10 03 3D 04 47 13 EB 44 DF 10 03 00 0B 3D 27 06 43 97 43 93 05 FC 67 27 88 00 10 23 22 92 01 AA 99 33 23 7B 92 02 5F 02 63 12 67 01 98 23 00 03 13 5C B7 44 E7 91 52 87 C0 01 29 01 A6 00 1C 00 29 77 29 00 03 12 A4 00 03 29 31 EF 00 03 10 22 2F 11 E1 00 03 EE 03 A6 00 03 05 4B 90 03 03 E9 EE EE 77 88 68 01 68 01 0D 4F 66 10 03 76 67 00 0A 10 03 21 7B 00 06 3E 77 67 00 03 10 07 11 8A 10 03 30 01 87 90 00 16 78 67 01 95 67 A6 99 99 00 62 9A 99 A9 76 A7 AA 6A 30 76 66 00 43 20 03 76 76 77 66 FD 00 21 00 06 10 2C 10 42 50 37 10 03 88 01 6E D6 01 D5 21 6B 4D 20 0F 87 01 86 01 5C 87 FE 01 70 12 2B 11 77 51 D7 91 DF C0 01 13 DF 5D D2 F0 16 30 01 DD 01 BF 55 55 12 05 3D CE 11 97 B0 03 D4 5D 00 03 01 AF 17 04 55 21 55 23 00 03 92 55 55 25 08 BF 2B 22 92 00 06 29 00 06 92 08 D3 06 AC E9 06 94 71 87 A0 07 29 10 07 92 92 11 61 BF 00 03 29 13 59 06 4D 31 78 00 38 56 CB 51 92 FF D1 B7 08 93 01 7F 03 28 01 86 60 03 01 8E E0 01 CA 41 77 01 38 78 78 03 09 87 00 06 88 4A 87 04 B7 77 78 13 18 88 10 06 66 05 87 78 77 76 88 01 B1 78 91 6A 2F 77 78 00 35 78 11 A8 51 78 51 77 34 FD EB 14 FA 00 04 01 7A 44 00 42 D6 00 2D 30 32 B4 72 F0 88 10 0B 51 83 D7 00 04 77 D7 81 00 03 77 46 44 88 78 67 03 17 34 78 66 00 50 03 5F DD 01 4B 55 33 0A 44 D4 35 23 00 03 22 70 03 55 09 23 46 44 5D 02 F5 53 D5 06 6D 54 D5 01 18 D5 01 27 53 30 03 99 52 AA 01 30 52 02 EB 29 01 83 25 00 03 22 88 10 03 4D 3D 25 00 03 52 22 4D 00 54 2D 25 D5 D5 55 22 55 3C 5D 2D 1A 5A 21 87 F8 3C 30 01 29 29 27 29 29 11 87 29 29 1A 12 03 49 26 D8 7F 23 19 FB 16 DF 5A 1F 58 57 50 03 78 7F 51 83 FD 01 7C 20 03 C3 1F F0 01 56 BF 14 EA 1E F6 BF FF 30 18 30 03 00 0C 16 66 34 C1 11 5C 81 9E 31 6D 7D 87 23 07 31 90 21 6F 00 03 16 17 4D 00 02 FB 36 83 04 78 10 07 F3 07 53 05 77 01 A3 08 5B CE D0 16 00 11 3D 33 00 43 01 A4 10 5B D4 F8 08 91 01 AB 11 CF 07 13 73 26 76 46 D4 0D 55 88 77 47 00 1D 12 16 88 11 D7 50 46 07 26 68 17 2B DD 4D 8D 88 53 55 06 D0 DD 01 85 48 5D 06 E4 08 BB 94 49 26 54 77 14 FB 47 05 63 D5 55 00 52 55 54 24 25 D5 45 55 20 52 5D 00 07 45 45 45 52 54 08 54 54 24 44 00 08 54 44 54 50 44 01 62 52 00 3E 55 52 22 52 97 23 61 52 32 38 C0 45 03 7B 15 1E 02 20 6F 22 00 03 18 BB 22 2A CB 45 2F 50 01 98 6B E5 10 03 01 DD 05 27 92 99 05 36 12 00 1C 7D 12 61 B7 01 6F 08 76 28 73 06 B0 E1 00 03 54 C1 00 03 CC 01 85 11 01 A6 11 EE 00 AA 11 11 BE AB 2A 11 BB 08 AB AA AA BB 00 04 BB BB BB 07 AA CC BC BB AB 00 2A 00 21 10 03 DF 20 33 20 01 1A 40 03 00 32 A1 DF 61 DB 20 2F FA 41 DF 23 57 11 E0 03 89 90 07 67 00 17 66 F8 01 D9 01 27 14 CF 06 FE 20 03 4D 44 D4 01 33 4D D4 3D 55 4D 34 0B A7 7B 5D 16 33 16 52 1A 7F 14 9B D4 18 BE 21 EB 20 D3 43 00 0C 35 DD 3D 53 35 64 D3 03 5D 0B D4 55 D3 01 35 35 3D BD 00 08 33 14 B6 2B 7D 1A 33 00 3B 35 16 80 C0 1C 2C FD A8 55 33 D3 44 88 55 5E 35 15 0B D3 01 BD 26 7B 7C 64 01 5F 88 D0 01 C4 01 F3 44 08 8F 88 4D 84 88 56 DD 02 32 3D 00 2A 53 50 2A 66 E7 48 FD 1B 3C 3C 68 60 42 19 0B 01 C3 20 A9 DD 2C B2 EE 58 CB 7E 3B B0 01 23 80 07 00 03 0D AF 22 3A 22 11 10 03 01 DB 00 03 12 00 03 11 2C 11 32 01 77 13 30 03 01 C3 C1 CC AB 01 C6 CC 00 06 CC 00 06 CC 00 06 20 03 8D 70 01 BB BB CC 01 C8 A0 03 BC 00 13 8B 10 0A CC CB CC 11 C3 AB 01 CC 40 03 04 E1 BB AA 11 EE 01 FE EE BC 07 BB EA EE CC AC F8 AF D0 01 16 FC AC 58 8B 66 47 13 66 05 91 20 01 66 76 7F 87 1D A2 91 75 2E F9 80 FC FB BF 4F 3B 4F 3F FF 52 EF B8 23 B0 3F 10 33 20 37 F1 54 20 12 D3 33 FF B0 20 FF E3 61 8C F0 1A F0 5E 25 47 0F 4F 2F 4E 32 23 13 00 07 00 03 23 32 15 62 25 12 52 55 15 01 AB CC 32 01 9C 13 F9 51 A3 81 A7 F0 01 F0 01 F0 01 CC 1C 00 03 A0 00 42 AC 00 03 1A 11 CC EA EE 29 EE CC 01 A4 1C 13 6F 11 E1 03 A3 7A 1E 03 CD 10 07 30 01 41 A6 BE 01 C5 BB 96 03 E7 BB EE 00 80 1E 80 8B 01 B4 87 49 67 10 03 67 66 03 93 66 D7 08 A0 BB 20 03 67 40 03 11 75 0B 69 5D 12 DD F0 01 DF 0D 90 41 5B 5D 01 09 12 E3 00 12 A0 2B F1 32 8B 01 56 33 23 52 03 6C D5 D0 1F 1D 98 60 D5 0E 6F F0 3F 33 53 33 52 55 02 C5 22 C5 CC CC 55 00 FC DD 51 CD 00 03 DD 10 03 CD CC 52 00 12 F2 00 16 F0 01 40 01 01 94 33 55 00 04 CC EC 05 64 00 2A 00 3E AA 04 D7 00 03 BB AA 30 AA BC 00 03 00 5A AA 23 55 A5 0C AA 55 AA AA F0 01 00 01 5A A5 3A AA CA 00 06 00 35 10 03 CA 10 3D CC BD 00 06 CC 00 06 20 03 F0 01 80 01 DC 10 A9 DD F0 01 00 01 AC 40 3E 00 03 01 C3 AC 02 24 AA 03 88 AC 03 83 AA 10 03 A1 10 07 1A FC 00 07 00 08 70 01 10 0C 25 B3 30 03 CA CC 7E 11 00 3D F2 4B 10 01 31 1D 10 03 0A 6B DD C0 03 8F 20 03 76 75 76 DD D6 5D 00 75 4D D6 33 52 34 DD 3D 30 23 44 18 0B 81 6A 4D 54 DD DD 00 24 24 45 45 44 23 24 34 F0 22 C2 12 D6 50 1C 11 AC 52 DD DD 54 01 22 55 4D 22 22 25 45 04 8E 60 24 26 74 B2 0D 44 DD D5 44 25 21 D4 42 00 20 52 22 25 52 06 8A 65 32 F2 31 90 2D DD 4D 00 06 CD 40 03 F5 E0 01 0E 42 00 C3 20 01 BC 01 49 BB 00 0E A4 00 03 BD 00 03 BC BB 20 0F CC BC CA 06 A1 16 AB BA AA 00 07 AB 00 07 BA E0 30 07 70 01 81 CA CA BA AA AA CD 07 AB BB DB DD BB 00 41 00 06 20 03 EB 01 CA 21 A8 11 2B DC F0 82 DD 00 16 F0 01 B2 30 01 BD 10 8F 01 CA AA CD 02 15 DD 6E AD 00 03 07 3B BD 17 3F 00 6C 00 96 AA A6 00 6F AA 01 C7 1A AA 01 C8 C2 56 DA 83 00 03 DD AA AA DB DD 52 4B 10 87 FE 00 03 E0 83 21 C7 00 07 F0 9B 30 01 14 68 3D 00 5D 33 32 D3 23 35 53 D3 01 23 5D D3 33 33 2D 5D 04 83 D0 10 03 58 21 32 00 0C 33 25 35 33 00 35 25 35 D3 5D 22 D5 2D 00 55 22 D5 23 2D 23 35 23 02 2D 32 23 32 22 23 06 5C 23 B0 24 BB 33 10 03 3F 37 D3 5D 33 35 01 3D 52 33 D2 33 52 35 08 47 40 32 00 1F 29 23 33 23 99 23 26 32 23 08 5F 23 92 00 29 56 A7 33 80 0A C8 44 22 45 42 22 29 92 05 22 25 29 92 29 1C 16 25 4A 69 98 0A 66 23 22 02 33 12 37 DD 29 D5 02 DD CD 29 45 44 C5 02 16 C5 88 00 1A D5 33 93 00 03 23 52 44 AC 03 20 CB 01 DE BC 26 8C 82 C1 44 CC 01 5C CC 22 C5 24 45 CB 01 C3 85 01 E5 BB CB CB BB 10 1F DC 12 DC BF 51 AF 54 01 14 12 14 01 C6 F0 01 F0 01 F0 01 EF 21 C3 12 4F 02 11 BD 00 03 00 6B 10 03 00 0A C4 60 01 21 C7 BA AA BA 02 56 AB BA 38 BA BA 10 07 22 66 40 1E DB AA BA 01 DB DD BA BA DD DD AB 00 84 FF 00 06 F0 8B F0 01 E5 3F 44 E1 00 03 16 E0 18 58 FB 16 96 37 35 31 9A 3B AB 05 68 22 08 C4 40 26 C7 38 80 25 34 23 25 3D 01 6C 22 0B 1A 11 F8 03 BB 05 63 20 19 05 98 05 97 52 33 35 00 22 55 DD 55 29 2D 52 5D B3 0C 66 D2 0A 28 03 9B 29 25 36 B7 10 03 F5 01 CF 00 5B 00 03 0A 7D 33 05 6A 35 00 03 5B 33 1A 86 55 1C 2E 01 C6 92 10 03 02 22 E1 00 03 30 63 57 93 22 45 99 55 03 E7 66 25 0D E1 0C 80 92 D2 4C 5E 01 FF 23 6A D2 10 2B 51 FF D4 01 19 44 01 5C 52 08 BB 1B 11 52 04 C0 DD 15 11 32 11 22 00 03 51 07 1B B1 30 03 11 D6 10 03 01 91 11 01 48 B1 31 4C 23 F3 BD 44 11 01 97 11 A1 BA 00 03 AA BD B8 05 1E DD 05 0F 10 03 93 EB BB BB 11 7F BB 25 3F 10 03 05 4F 03 7C 00 35 11 D2 03 F3 60 E1 00 5F 00 03 11 BE DD DD E1 FC 10 63 00 5B 10 03 60 01 24 10 02 06 AA BA 37 BB BD 03 9C 00 03 11 10 03 D3 EF 42 15 5E BB 03 D0 BB 00 61 34 49 14 71 00 33 BB 2F 1A A1 00 03 11 0B 43 40 03 00 0C 11 BC C3 95 C4 D0 01 23 22 FF FF F0 03 70 03 FF F0 31 F0 01 10 01 CC 0B 00 39 30 01 50 47 10 11 BE 20 03 F2 00 03 50 1C 00 01 F9 D1 BD C3 E1 09 1E 91 99 EE 00 03 1E 11 30 03 4F 11 60 03 99 99 00 02 0F E4 6F DB 30 03 FF 8E 50 FE 90 60 01 14 22 40 07 22 B1 64 AD F0 01 FE 22 F1 C0 03 39 D6 EB CC B0 01 2B 6B 0B DA 44 A0 40 03 D4 00 03 DD 35 4D D4 53 04 D3 44 5D 55 8D 10 03 4D 5D 7B 55 1C 2B 12 E7 FC 19 1B AD 3D F0 64 C0 01 DF 3C F2 2D 43 91 00 03 01 2B 00 03 01 1F 50 03 6F 91 11 23 70 01 29 00 03 A1 2F 11 23 F1 27 FF F0 01 21 23 5F B4 45 AC 10 03 15 68 73 C7 65 96 FB FE 1F 60 45 23 EF 61 6E 35 AA 32 61 83 20 63 FF 66 09 BB 28 2B 93 2B 67 30 03 F1 33 41 38 0D 97 B2 0D 53 D4 0D 53 0D 57 55 D3 30 03 35 53 8D 30 03 D5 00 17 D5 44 0D 90 20 03 09 88 48 3D 55 20 03 D8 D8 0D 6B 03 48 DD 87 88 48 44 10 03 00 0B C7 00 03 0D 97 D3 D4 DD 00 26 0E 14 FF C4 F2 10 01 5B FB 1C 67 1E 05 44 D4 0E 33 D4 8F 0F 8B 44 DD 3D 1F E6 91 8B 20 03 31 A3 FF 11 AB 2E F7 62 B7 F0 03 20 03 51 6B 61 1B 46 DA FF 31 33 F1 28 BC 76 22 AB C2 CD 15 B7 7E 67 F0 37 72 53 F1 57 F0 01 82 A4 D3 88 20 03 35 25 D5 44 10 03 35 53 00 07 D5 02 E8 69 5D 0B 49 00 4B 3D 1E E0 DD 4D 01 4B 18 D8 4D D4 00 04 0E A9 78 44 44 60 8D 1F 76 01 5D 44 84 8D 78 48 0A 44 84 78 47 00 03 77 0E E3 77 00 4D 8D 88 78 D7 87 88 88 7A 77 0E EE 20 05 01 42 01 76 5D 1E C3 23 C0 03 41 07 EE 35 92 4D D4 35 23 42 48 00 13 D8 44 D4 5D 00 5A 44 04 33 D5 44 44 22 10 03 53 4D 2A 44 29 00 03 32 00 03 33 00 83 55 1F DD 4D D4 51 67 E0 03 1C 9B 00 03 61 6B F7 13 13 20 03 13 1F 30 03 91 21 80 F0 01 44 3F FF 32 B3 20 0E 0D 6C 06 78 01 A9 1A B4 13 04 60 07 FE 30 23 31 AB 52 FD C1 B5 41 AB 72 D3 30 03 D3 B8 07 67 4D 0C A6 D0 01 00 16 D3 DD 3D 7F D3 02 8F 00 FA 12 DF F0 21 00 50 2A DF 30 1F C0 40 52 27 D9 95 53 55 88 92 35 00 22 88 92 3D 23 88 28 DD 1A 35 83 38 12 54 05 2C 32 00 F0 32 33 99 92 00 03 10 07 29 22 00 07 00 DF 26 29 32 11 5A 44 55 00 68 F0 03 44 60 44 01 62 01 CD 88 88 8D 78 87 04 88 74 88 87 88 03 38 88 44 50 7D 00 03 74 10 03 77 88 44 D4 B6 21 C0 44 51 EC 20 03 48 B0 03 00 A5 74 A4 00 1E 6D 30 03 D4 67 00 03 66 44 2B 44 74 10 03 77 00 12 77 86 0F 04 E7 7D 1E 40 03 1E 57 31 C7 00 02 90 01 91 26 17 EF 04 F4 16 1B 10 03 91 01 D3 50 03 93 57 64 F7 F4 84 D3 1A 88 76 1A 44 AF 23 11 C7 32 32 FF 01 DF 00 09 28 58 82 03 31 C9 63 9F 74 D8 29 4D D9 10 03 05 EC 44 10 03 01 2F D4 35 02 DC B5 00 03 88 86 13 21 1B 84 03 20 4D 32 EE A5 20 01 84 00 03 44 D4 23 23 8D 94 6B 25 77 47 00 2F 88 D7 00 2A 77 10 2A 80 20 2E D4 5D 83 38 44 D4 85 70 58 00 2A 03 5B 00 03 D4 88 D8 87 83 01 8B 77 77 77 87 78 00 03 02 99 BE 13 D3 D5 3E EE 12 31 30 01 10 09 00 30 44 F2 12 24 F4 D7 90 01 01 D7 44 88 01 8B 76 AA 40 03 6D 00 03 64 10 03 76 00 03 66 EA 23 D1 01 D8 50 03 87 20 03 D8 20 03 77 88 10 1C 44 67 77 01 D2 77 44 74 2E 76 87 20 03 6D 00 03 00 97 00 03 88 0F D4 76 77 88 E3 97 51 DB 40 03 46 BF FF 16 B7 50 03 A3 A3 F3 9A 21 9A 4C 55 2A 0D 76 5F FF 00 07 5A 1E 12 F7 31 BD 15 23 03 1A 13 70 04 C8 A3 00 0A 4D 30 03 D3 D4 33 06 43 01 BA EA 21 2B 20 01 0E 10 D4 07 AC 3D 00 3D 35 86 00 65 35 92 92 99 22 C1 06 51 44 40 5D 0E CB 35 92 99 55 33 92 E4 34 45 08 99 00 9E 92 DD 01 EF 55 4D 24 84 88 06 3F 8D 32 03 4C 39 53 00 DD 44 29 32 D5 4D 99 32 13 33 DD 99 00 08 88 77 03 34 01 A8 BB 11 D3 D4 00 03 25 08 25 23 84 21 FF 13 33 14 77 77 4D 00 03 D6 00 03 66 D7 00 77 77 67 76 87 77 67 66 CE 00 2A 00 03 87 68 F1 AF 00 2F 00 03 76 B7 00 33 66 10 38 23 4F 44 10 03 01 AF 60 03 88 60 13 77 87 D8 00 27 88 4D 66 52 76 20 03 D8 00 5D 88 77 00 10 77 4A 67 22 43 88 74 01 A3 7D 00 03 6D A6 00 03 67 10 03 66 87 20 03 10 23 78 DB 00 07 41 A7 E1 39 AE F0 01 9E 01 B3 80 03 37 99 EE 50 03 00 0C EE 00 08 F1 BB 33 97 EF 59 C3 41 C7 31 BF 32 23 7D 01 BE 65 83 55 4A CE 03 6B 21 C7 55 32 14 E9 80 03 03 7B D4 FD 07 BF 07 C7 04 AF 01 C0 00 0E 00 12 3D 00 0E C1 08 22 07 B0 3D 92 22 99 5D 00 6A 00 DD 5D 25 22 4D DD 5D 35 3F D3 44 27 EE 10 04 20 33 04 2B 01 C7 21 D2 04 29 23 92 99 29 0E 90 29 5D 0D 35 23 23 DD 00 6D 00 2A 33 05 2E 00 D5 99 29 52 D5 22 22 53 02 D5 22 32 53 DD 92 06 7C 92 CE 06 84 10 03 22 32 06 FB 02 EB 01 D2 77 D6 10 08 31 DB 8D 01 DB D4 13 53 15 23 77 03 68 76 77 76 88 76 41 6D 13 B1 79 77 10 03 01 78 10 0E 13 E7 DD 7D 11 E8 0F 77 66 86 78 01 F9 00 14 01 B1 20 03 F3 00 1E 10 03 01 E3 10 03 88 66 00 13 00 03 C4 01 9B 00 45 66 77 78 00 03 87 78 7D 67 20 4D 02 5A 17 51 05 A8 80 07 87 00 07 0D 78 78 87 87 F1 B1 DB 83 9E 01 A7 EF 4A 57 18 B7 0C F3 1E 0D 07 1C 7B 10 03 9B 6F FB 20 03 75 63 26 47 78 AB 48 B7 23 03 77 0F D1 FF 2A 05 63 7F 57 03 25 33 C7 1C B8 8D 95 5B 3A 15 E6 08 6F 29 E7 50 03 35 4D 79 F3 11 C1 DD 78 55 94 E2 15 33 46 92 20 01 35 33 DD FD 00 33 69 DC 06 8B 45 84 25 87 63 F9 67 11 AB C4 11 3E 30 01 D8 DD 44 0E D7 44 3D 10 22 22 74 03 34 66 77 66 87 EF 21 AB 40 1D 0E 6C DD 08 82 08 7F 20 4D 10 17 F1 01 74 50 39 95 85 13 DB 77 87 87 00 01 35 78 78 00 22 00 07 8D 00 08 44 01 9D 8B 32 2B 7D 77 78 01 F4 78 01 F0 11 F8 F7 22 18 90 01 11 FC 22 2A 87 12 0B 12 38 10 07 C0 A0 01 4D 47 A1 EE EE AE AA EE 00 EE BA AA EE AE BB BB EE 40 AA 00 03 BA BB BB AE BA BB 71 CC 01 CA 0E 36 0E 3E BA BB CB 0E 45 41 CC 30 03 CC CC CB CC CC 20 01 55 93 01 B3 9B 01 C0 9C 00 07 9C 01 CF 50 CC 01 DB CC 00 0C CC CC 3C 23 FF 10 1F D1 AF 27 0B 4A A7 FC 0F F0 01 9A 9A D1 DB FF 31 DF 3D 47 40 03 1B C7 01 DF 20 03 19 1B 17 42 7D 84 38 5A 16 6C 08 50 40 01 01 7A D4 01 DA 7C 3D 11 C2 70 15 70 01 2A 37 02 1D D4 2D 01 99 99 D4 25 92 99 D4 03 E5 43 D4 02 B5 D4 55 22 22 0D 9A 0B C3 A8 39 3F 52 01 C4 22 05 AF 29 32 55 82 03 CF 55 4D 32 33 55 00 7B D5 EE 05 F5 51 C5 18 A7 D4 15 72 03 D7 20 03 D4 FC A5 8B 13 B4 43 B8 11 8F 10 0A 03 9B 76 7D 03 66 77 67 84 67 76 03 A1 D0 01 F7 10 27 01 D8 00 29 04 16 76 21 8F 01 8C 01 92 D2 61 93 B0 01 3C 01 8B CC 33 C0 14 1C B4 40 03 11 21 85 00 04 CC 01 93 1C 2C 04 33 33 11 C1 32 30 03 11 2C 9E 00 03 C1 3C 25 27 73 83 83 78 0A 2D 15 57 51 00 14 DD 93 80 35 1C 3F B0 26 0B 67 DA 10 03 03 43 53 08 63 00 1F 53 80 53 33 9F F1 76 D4 33 0A BE 25 9C 10 27 F1 93 10 4B C0 13 D3 10 03 33 4D 84 77 66 67 02 44 78 67 66 44 84 00 03 44 AD 50 03 6D 00 03 64 2A 27 01 29 76 04 F7 7B 77 10 08 20 07 50 0B 00 08 66 00 08 F1 2F 0F CC CC DD DD 10 03 30 01 F0 1D 30 01 76 CD 10 27 F0 16 70 01 DC 10 20 10 25 1C 68 11 01 66 30 03 AC 00 03 1A 11 11 45 AC 40 03 AA A1 A1 1A 93 C1 BA A2 C0 B0 01 11 80 C1 5C C5 CC 11 C1 FA 00 41 11 B0 00 03 00 0A 11 BB 1A 10 03 C5 01 11 11 35 1C 11 11 31 00 03 6E 5C 00 2E 00 65 C1 40 03 30 75 93 77 55 80 00 04 CC 25 32 33 CC 5C 55 60 55 50 A6 BD DA CC 25 53 C5 CC F4 00 6D 70 C6 2C 77 60 03 53 10 42 53 55 8D 12 2F 5C 55 35 00 1E 00 49 55 0A 3B F1 23 7B DF 64 25 BB 49 15 3D 33 53 5C AA 81 12 13 C5 CC 33 C3 CC CC 10 67 AD 31 D3 DD 03 33 33 15 8F 2C 8C 3C 00 03 79 CC 03 E2 10 7F 03 BE 01 C7 84 66 01 8A 55 67 00 4E 67 00 1A 77 00 03 67 00 8E 5D 77 00 9C 68 01 C7 01 C6 20 03 67 30 03 FE 05 6D 30 03 20 14 11 82 91 CF D0 01 00 18 AC 84 00 03 AA DD DD AD 40 03 AA AA B0 00 06 AA 00 06 20 03 AA 1A 1A 1A BD 01 A7 A1 A0 07 10 17 40 01 01 73 D1 06 F2 00 DD 1A A1 AA DD A1 A1 DA 22 DD 1A 30 41 DD AA DA 20 54 DD 0A DD CD AC A1 00 62 1A 00 0D A1 F4 20 57 40 5B 00 06 10 03 DA 11 D7 1A CA 15 CC CC A1 00 EB AA 00 03 DA 42 36 EF 50 B3 F2 58 52 A3 CD F0 1F 12 76 10 3B 60 3F F9 F0 37 C0 01 01 BF 91 ED 10 0C 55 D2 00 15 00 22 CC 5C 5D 22 55 D5 22 50 25 30 25 D5 00 03 D2 5C CC 25 20 D3 35 00 03 22 5D 22 D3 22 2C 52 29 0E BB 29 02 07 83 0F D2 5C 00 CD CC D2 DC D3 CC DD 25 06 D2 DD 22 25 D2 0C EB 02 6B CC 2C CC 78 00 03 74 D0 03 00 2F 74 5D 19 DD CC D3 51 B8 13 90 67 67 00 07 B1 13 AD 67 05 05 00 07 7D 57 6D 11 F7 A1 50 01 AD 40 03 AB DD DD BD 00 03 7D BB 10 03 21 47 F0 01 F0 01 40 01 DA 40 03 BA 01 82 DA 30 03 00 50 01 AA BD 00 06 BB AC 30 03 BD 40 03 BB 20 03 30 2F BA DD 00 AB AA BB DD BA AA DB DD 1B AB BB DB 40 19 00 03 DB 21 E0 F2 5B B4 30 01 4D 00 02 15 7B 5C 00 22 5C DD 00 5D DC 5D DD 25 52 2D DD 20 25 22 04 B8 92 22 2D 52 92 00 29 55 22 94 29 22 D2 22 02 25 22 29 25 32 25 0F 63 52 7C 92 2E 51 37 1A 0C 86 10 03 29 07 32 53 7A 35 00 03 25 83 06 5F 10 06 DD 00 03 3D A0 03 8B 35 5E 4F 53 3D 33 35 53 0A D2 5D 22 53 00 50 DD 00 40 D3 80 08 7B 33 D3 23 32 53 D3 DD 00 33 25 D2 D3 33 2D D3 33 4B 33 1C 97 33 23 0B 24 23 19 65 10 60 00 33 33 7D D7 D3 66 D3 3D 3D D3 D6 00 0A 00 1E 34 27 40 63 53 17 5C D4 50 CC 11 1C AA 00 FF 11 10 03 A1 DB 4D BD 00 03 BB 11 08 17 01 2A AB 01 0C 07 BA BD BB BB AB 06 8B 00 01 01 29 03 AB AA 11 BB AB 11 20 03 41 77 00 BA AB AB AB AB AA BA BA 4C BA 08 47 BB 11 00 25 00 03 AB B1 E0 10 2C 01 80 00 12 DD AB AB BA DD 5A BA 00 54 AB 08 70 0A 3C BA 0A 3C BA 48 1B 03 5C DD CD 00 1C CC BC BB 13 CD CC CB 00 03 BC BC 16 E3 16 EB AD 06 F3 BC 00 37 BC 11 83 51 B8 DB 20 7D F6 08 AF 00 98 10 03 00 3E BA 10 BB 00 22 55 A8 00 03 25 00 23 25 01 C6 4D 11 DA 28 55 44 03 B6 22 00 1F 2D DD 5D 00 45 22 45 5D 22 25 42 44 00 22 52 22 22 24 29 52 25 1D 22 39 24 01 88 10 03 2C 45 25 4C 4D 7F 23 0E 2B 41 1D 11 27 11 3B 31 A6 11 AD 11 4E FC 01 58 00 14 41 8F 04 FC 15 00 0C 6F 33 23 30 D2 23 01 8D 01 5E 23 33 35 D5 D8 00 15 15 08 53 68 B3 00 54 23 23 29 DF 00 5B 1A F3 32 00 47 10 4B D9 2F 30 03 37 83 FF 00 3A 2C B7 45 2B 11 A3 20 03 00 0C 07 7C D5 86 00 55",
         tilemap1 = "10 00 05 00 31 C6 E0 F0 01 30 01 C7 E0 0E F0 01 81 A0 01 00 00 00 00 C8 E0 F0 01 E1 30 01 F0 3F F0 3F 00 00 C9 E0 F0 01 B0 30 01 CA F0 31 F0 3F 00 01 D0 02 00 D0 03 D0 04 D0 05 D0 06 00 D0 07 D0 08 D0 09 D0 0A 02 D0 0B D0 0C D0 0D 40 01 CB 0C D0 CC D0 CD 00 17 30 01 CE D0 00 CF D0 D0 D0 D1 D0 D2 D0 08 D3 D0 D4 D0 10 3F 0F D0 10 00 D0 11 D0 12 D0 13 D0 14 08 D0 15 D0 16 00 23 17 D0 18 08 D0 19 D0 1A 40 3F D5 D0 D6 20 D0 D7 00 15 D8 D0 D9 D0 DA 00 D0 DB D0 DC D0 DD D0 DE 02 D0 DF D0 E0 D0 E1 20 3F 1B 00 D0 1C D0 1D D0 1E D0 1F 00 D0 20 D0 21 D0 22 D0 23 00 D0 24 D0 25 D0 26 D0 27 22 D0 28 20 3F E2 D0 E3 20 79 E4 00 D0 E5 D0 E6 D0 E7 D0 E8 00 D0 E9 D0 EA D0 EB D0 EC 20 D0 ED 20 3F 29 D0 2A D0 2B 00 D0 2C D0 2D D0 2E D0 2F 00 D0 30 D0 31 D0 32 D0 33 02 D0 34 D0 35 D0 36 20 3F EE 00 D0 EF D0 F0 D0 F1 D0 F2 00 D0 F3 D0 F4 D0 F5 D0 F6 00 D0 F7 D0 F8 D0 F9 D0 FA 20 D0 FB 20 3F 37 D0 38 D0 39 00 D0 3A D0 3B D0 3C D0 3D 00 D0 3E D0 3F D0 40 D0 41 08 D0 42 D0 43 20 3D FC D0 FD 00 D0 FE D0 FF D0 00 D1 01 00 D1 02 D1 03 D1 04 D1 05 00 D1 06 D1 07 D1 08 D1 09 10 D1 0A D1 10 3F 44 D0 45 D0 00 46 D0 47 D0 48 D0 49 D0 00 4A D0 4B D0 4C D0 4D D0 04 4E D0 4F D0 50 20 3F 0B D1 00 0C D1 08 D0 0D D1 0E D1 00 0F D1 10 D1 11 D1 12 D1 00 13 D1 14 D1 15 D1 16 D1 10 17 D1 18 20 3F 51 D0 52 D0 00 53 D0 54 D0 55 D0 56 D0 00 57 D0 58 D0 59 D0 5A D0 01 5B D0 5C D0 5D D0 5E 00 3F 00 19 D1 1A D1 1B D1 1C D1 00 1D D1 1E D1 1F D1 20 D1 00 21 D1 0E D0 22 D1 23 D1 04 24 D1 25 D1 26 20 3F 5F D0 00 60 D0 61 D0 62 D0 63 D0 00 64 D0 65 D0 66 D0 67 D0 00 68 D0 69 D0 6A D0 6B D0 00 6C D0 6D D0 27 D1 28 D1 00 29 D1 2A D1 2B D1 2C D1 00 2D D1 2E D1 2F D1 30 D1 00 31 D1 32 D1 33 D1 34 D1 40 35 20 3F 6E D0 6F D0 70 D0 00 71 D0 72 D0 73 D0 74 D0 00 75 D0 76 D0 77 D0 78 D0 00 79 D0 7A D0 7B D0 7C D0 00 36 D1 37 D1 38 D1 39 D1 00 3A D1 3B D1 3C D1 3D D1 04 3E D1 3F D1 40 00 83 41 D1 10 42 D1 43 20 3F 7D D0 7E D0 00 7F D0 80 D0 81 D0 82 D0 00 83 D0 31 D8 84 D0 85 D0 00 86 D0 87 D0 88 D0 89 D0 04 8A D0 44 D1 87 00 0B 45 D1 40 46 00 41 47 D1 48 D1 49 D1 10 4A D1 4B 00 3F 0E D0 4C D1 40 4D 20 3F 8B D0 8C D0 8D D0 00 8E D0 8F D0 90 D0 91 D0 00 92 D0 93 D0 94 D0 95 D0 00 96 D0 97 D0 98 D0 99 D0 00 4E D1 4F D1 50 D1 51 D1 00 52 D1 53 D1 54 D1 55 D1 00 56 D1 57 D1 58 D1 59 D1 04 5A D1 5B D1 5C 20 3F 9A D0 00 9B D0 9C D0 9D D0 9E D0 00 9F D0 A0 D0 A1 D0 A2 D0 00 A3 D0 A4 D0 A5 D0 A6 D0 00 A7 D0 A8 D0 B6 D0 5D D1 00 5E D1 5F D1 60 D1 61 D1 00 62 D1 63 D1 64 D1 65 D1 00 66 D1 67 D1 68 D1 69 D1 40 6A 20 3F A9 D0 AA D0 AB D0 00 AC D0 AD D0 AE D0 AF D0 00 B0 D0 B1 D0 B2 D0 B3 D0 18 B4 D0 B5 00 3B 10 01 6B D1 6C 01 D1 6D D1 6E D1 6F D1 10 0D 00 70 D1 71 D1 72 D1 73 D1 04 74 D1 75 D1 76 20 3F B7 D0 00 B8 D0 B9 D0 BA D0 BB D0 00 BC D0 BD D0 BE D0 BF D0 00 C0 D0 C1 D0 C2 D0 C3 D0 00 C4 D0 C5 D0 77 D1 78 D1 00 79 D1 7A D1 7B D1 7C D1 00 C5 D0 7D D1 7E D1 7F D1 00 80 D1 81 D1 82 D1 83 D1 7F 84 20 3F F3 95 F0 01 F0 01 F0 01 F0 01 F0 01 F8 F0 01 F0 01 F0 01 F0 01 90 01",
         palette1 = "FF 2F DB 7B 93 4B 0E 3B A5 35 AB 3E F8 36 32 2E 8D 25 D9 63 56 73 EF 66 6B 52 08 46 DE 7F A4 14 FF 2F DE 7F 89 3D 5A 6B 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00";

      // first-person-view / 1
      private readonly static string
         tileset2 = "10 80 2D 00 30 00 00 F0 01 90 01 E7 E7 E7 E7 0E 7E 7E 7E 7E F0 07 F0 07 20 07 EE 00 E7 66 EE 67 66 66 7E 77 9E 10 03 77 66 80 1F 10 06 00 19 B0 01 44 67 44 F0 01 90 01 EE EE F0 01 F0 01 E0 01 58 7E 40 03 77 10 83 00 03 67 77 77 99 10 01 67 76 00 0E 50 03 66 77 C0 8D C1 10 0E 80 12 88 66 66 86 FF 40 4F 5B 22 00 02 22 00 02 30 03 2E 00 03 00 04 FF 30 1A 00 0C F0 01 20 01 F0 19 F0 01 40 52 F0 01 BF 20 01 E2 30 7C F0 23 30 38 80 F0 10 0D 40 27 7F E2 10 37 30 39 90 01 30 8D 20 24 F1 2F 00 16 0D 66 66 22 62 00 03 21 B7 67 21 BB FB 11 30 11 43 10 03 01 0F 10 03 76 31 1A 10 06 7F 76 01 2A 01 46 00 05 20 03 40 20 E1 E0 01 43 CD 01 4A 00 03 F8 FF 00 0A 10 03 8F 00 0A 00 FF 66 F8 8F F8 66 F8 88 7F F8 F0 89 90 93 41 00 F1 DB F0 03 40 A3 10 8A BF 00 08 76 50 08 31 F7 F0 01 10 01 00 BD 40 2A C0 30 03 02 16 57 77 66 75 57 77 20 67 55 00 07 56 55 77 55 55 60 55 10 CF 70 58 57 66 75 75 55 05 B6 55 55 45 BB 00 03 DB 00 03 00 8B 66 88 C8 88 66 8A C8 00 CC 66 BA BB CB BB AB BA 00 BB 88 88 A8 BA 88 C8 CC 07 AC C8 CC CC CC 10 03 F1 B2 C0 E3 FF 00 E1 21 BB F0 E9 E1 C0 F0 12 31 D6 52 67 F1 DB FF 21 43 F0 80 90 1F A2 5F F0 5E F1 67 31 6B 30 03 7C 6E 22 00 11 46 12 2B 80 03 10 01 F8 77 1C 77 87 FF 11 63 50 03 21 73 D7 DD 00 DD 88 FF FF FF FF 88 88 00 88 8F 88 DD DD 77 66 55 48 55 21 6B 66 66 10 03 44 DD DD 20 DD DB 00 1D BD 88 88 D8 BB 00 CD DC DD DD 55 54 44 CB C0 10 03 34 0D BB 8B AD DA BB FD 00 DB 8B BD FD DD DD FF FD 0A CD FC FF FF 01 62 AA 00 02 AA 0C A4 AA AA AA 00 52 00 5A 8F BD A7 00 03 D8 30 03 88 D8 F3 02 53 BF F0 01 F2 12 6E F1 06 F0 01 70 01 6E E6 41 22 66 DE 00 03 01 0F 77 30 03 03 3C 00 06 14 7B 77 72 EE 63 33 92 47 91 33 87 FF 90 03 76 2F 77 86 10 03 DF 03 37 20 03 11 23 10 03 00 FF DD DD CC FD DD CC CC 28 FD D8 30 03 FF 10 03 88 CC DD 08 DD CD DD BD 01 27 DB CC DC 20 DD BD 01 0B BB CC DD 8D 88 54 DC 01 07 DD 03 63 DD 00 04 BD DB 12 DD DD BB 10 03 CB DC 00 07 CD 5C DD 02 9B CC 00 1E 10 03 11 86 8F F8 00 88 D8 DD 8D D8 DD DD 8D E8 01 78 11 7B 30 03 BD 00 4F BB DB BB 13 BC BB DB F0 F2 E6 7E 03 69 00 DF BF 30 C2 EE 05 D2 34 2F 10 D3 50 03 53 7B 24 21 FF 30 29 35 71 54 26 60 01 42 2F 70 37 44 4B 34 3A 64 88 15 83 41 0B F8 DD 40 03 D8 66 06 66 FD D8 66 86 02 47 00 B7 FF 06 C8 CC 88 FF C8 02 08 00 03 8F 59 D8 00 03 DD 00 D4 00 03 DD FD 10 FF 01 FD FF DD D8 88 FF DD 02 4C 60 DF 20 EF 10 03 CF CC FF DF BC 01 BB FF DF BB BB FF BD 00 03 00 FF BF BB CC BC BB BB CC 04 BB BB BB DC DB 00 03 BD BD 85 01 2E BB BB BD DD 10 07 B4 00 15 AB F0 01 4B 00 03 5B 00 1A 5D 00 03 21 13 00 FE FF FF EE AF AA AA AF 01 9A 99 99 AA 99 99 99 00 06 AA 10 01 19 00 03 11 10 1E EF 00 03 FA 80 00 04 A9 AA EF EE 19 AA FA 00 EE 11 AA FA EF 11 A1 AA 07 FA 11 A9 9A AA F2 53 70 01 10 37 FF F0 01 80 01 15 9D A3 93 B2 83 12 7F 41 7D 51 81 EA 61 85 65 B7 30 0F 88 30 03 86 30 03 67 EF 40 03 11 80 32 27 FF 13 58 20 0C E0 01 01 83 5C D8 12 9E 8D 12 49 00 0E B0 03 DD CC 62 DC 20 3A 02 8E FF 88 DF 01 B3 88 35 DD CD 01 8E 00 07 C8 00 03 CC 10 03 5A FC 00 0E CD 01 CA 10 01 CD 02 C3 CC 2C CC 8C 00 25 8C 30 11 01 A6 BB CD 1C BB BB DB 01 A3 10 03 03 01 BB DD 06 C8 CC DB DD D8 00 3A 10 73 BD 00 DD 44 D4 DD 8D 58 44 DD 00 D8 BB 45 8D B8 BB 45 58 00 55 45 55 F8 BF 54 55 F8 00 DF 4B 44 F8 FF BB 43 5D 00 D4 4D BD 5D D4 44 B8 54 00 44 D4 D8 55 44 D4 5D 45 02 44 54 45 44 55 45 14 4C D4 81 00 03 DD 99 11 11 11 19 00 03 B0 00 01 91 40 03 A0 01 91 99 99 A9 E8 01 C7 00 06 10 03 19 E0 23 EF E2 E2 05 E2 2F 2E 2E 2E 10 07 FA 00 07 64 F9 10 07 04 42 11 2F 00 03 F9 2F 55 22 00 0E E2 00 16 2E 00 06 72 00 06 40 77 00 06 77 22 22 77 77 22 61 72 00 03 01 95 72 67 E6 72 28 96 80 93 3E 65 65 75 77 65 55 65 B0 06 7E 55 86 AE 23 27 57 57 67 66 05 57 55 66 88 55 20 03 55 01 A7 DE 47 89 77 9C 66 11 95 21 6F 01 3F 01 D6 88 61 76 47 73 07 7E FF F8 FF DF 03 1D FE 00 03 01 8B 00 01 61 B7 21 6D 13 33 14 37 88 C3 03 42 05 9D 8D 88 8D D8 61 C7 35 B6 BA 00 3B FF 01 EE 31 AC 10 01 88 11 88 C8 01 CC F8 88 C8 8C FF 8D 03 8A 7F DD 11 BB 10 32 11 E9 00 03 13 74 23 77 02 3D DC 15 F3 90 01 B8 01 D7 10 23 02 0D F8 D8 00 8D 88 FF D8 8D F8 FF D8 B2 00 B9 D8 12 55 20 3E D8 8D 03 9F 3B E1 00 71 03 A7 00 03 8F DD BB 8F 01 E8 18 DD FF 88 05 E3 20 26 D8 44 44 10 55 44 43 01 C8 4A 44 44 34 00 3B 44 34 B3 BB 3A 3A AA 00 BB AA AA AB BD BB AA BB 13 DD BB AB 03 8E 11 11 13 87 33 92 FA 23 93 23 97 10 03 01 DC 51 C6 A9 00 0C 9A F0 10 29 11 F0 20 03 41 F4 DA DD FA 22 00 AA AA AD FF A9 AA DA AA 43 99 00 08 99 A9 AA AA 20 03 40 50 D0 01 C6 10 01 55 05 BC 57 AA FF 55 00 55 AA AA 58 55 A9 AA 8A 7D 88 00 2B 20 27 11 C3 80 01 01 B3 85 00 25 00 85 8F 58 55 85 88 8A 58 6D 85 21 C3 00 0F 8D 00 06 11 2D DD 01 27 FB 01 63 05 BE 05 94 21 74 30 03 FD 14 EA 15 CF DE 93 5A 00 03 8D 21 90 01 D0 41 9B 01 41 DF FF 01 4D 31 9B 11 A7 10 26 11 DC 20 03 40 4F 00 0A 8F 00 21 8D FF DC 10 4F 51 C7 11 85 00 7C D9 02 02 01 AF DF 00 03 11 EF DD B8 30 41 20 DD BB 06 13 FF DD BD FB FF 07 88 FB FF FF B8 00 68 00 06 10 28 BA 00 07 8F 10 0E 10 0A 40 03 8F 51 EB D8 90 00 06 DD DB 01 E5 BD B8 8B 88 3A D8 8B 00 10 10 03 17 D9 BD 00 6C AB 81 00 06 AA 88 BD AA 8A D8 01 A6 2B DD BB 01 AF 88 05 8E 9A 00 03 01 BB 2D BB 9B 03 F6 AB 10 03 00 0B AA 00 02 60 BA 20 BB 00 4F 99 99 89 D8 99 24 AA 9A 01 5E 9A DA 01 62 A9 11 7F 91 03 BD 10 03 73 C3 21 F1 83 BF 21 C7 80 01 3F 19 19 10 22 43 F5 00 0F 61 CB 10 01 32 18 FE 70 01 00 63 A0 1F 20 23 22 38 10 03 00 3C 8A 2A 88 88 02 1B 88 01 EB 88 00 1A 8D B8 00 03 8A 12 36 00 75 04 37 11 A9 F8 C0 03 67 13 8B F8 F5 F5 FF F8 5F 1A 55 FF F8 00 C3 11 97 D8 03 6C D8 CF 13 6F 03 62 DF 8D 02 FC 03 6D 01 B9 10 E6 77 DD 13 9A 81 AB 10 03 CD 83 72 01 B3 11 9D 97 15 49 CD BB 15 5D 8D 03 33 02 12 41 BB 40 F5 00 02 55 FF FF 5F D5 DD 20 DC FC 05 98 FD 8D B8 DF DD 04 8D 8B D8 DD B8 03 4D B8 88 1A DF 88 8B 02 3B 00 03 88 00 12 8D 77 DB 0A AF 40 01 42 1F D8 01 74 01 73 40 01 55 DB 10 91 BD 01 FB AB 20 03 BD 31 93 C2 40 03 02 13 DD AB AB AA 01 C6 AA 3B DD AB 11 27 F0 01 03 88 BA 03 8D 50 03 5A AA 00 26 BA 00 06 10 0A BA 00 01 AB B0 00 09 BA 03 56 40 03 BA BB 9A 99 C3 02 02 00 03 99 99 BB 9B 00 03 07 48 C0 51 C3 60 01 49 93 99 11 34 91 00 49 41 33 11 34 34 13 11 7F 34 21 C3 20 21 11 B9 01 D9 40 08 23 E4 41 C3 FE 10 08 90 03 72 2B 01 C3 23 EF D5 F5 80 2F 19 FD 14 1B 60 03 10 12 56 03 20 03 28 6E FD 15 6A D6 03 27 00 05 DA 01 48 DA 01 34 00 03 D8 FA 10 07 21 BF 0A C7 05 26 06 DC BC 00 03 BB 30 8B DD 00 03 07 04 8B 8D 88 BC 28 8B DD 08 B2 CC 08 BD 8D FF 8F 59 C8 05 72 C8 01 89 03 21 88 BC 1A FF A8 10 03 CC 00 53 CC 07 0B CC 8B DD 10 8D BB 8B 03 4C 8D B8 8B BB 08 8D DB 88 BB 01 C3 DB 88 FB 4F F8 06 F3 AA B8 08 B0 01 D1 00 2F 10 03 D0 43 61 00 03 8F 13 62 9A 8D 88 BB 25 AB 99 00 03 AA 89 00 03 9A 30 03 C0 11 78 00 03 BA AB AA 8D 8D 8D 61 AB 00 6F 00 37 B8 BB 8A 88 01 79 52 D9 00 03 9A 05 37 A9 A9 02 F7 9A FB 11 C2 11 B9 13 82 00 3A 01 F8 BA 23 90 20 03 F5 00 0A 30 08 30 01 13 B3 9A 30 03 AB 20 67 98 01 ED 9A AB D3 3C B0 01 A9 34 13 08 41 33 33 11 10 03 34 44 33 0A 49 44 34 33 00 02 43 20 03 33 38 13 43 00 06 11 8B 05 DE 13 34 33 2C 13 11 00 02 11 00 02 00 01 41 34 8E 05 EE 33 44 33 00 11 55 AF 81 BB 33 FE 32 34 22 0B 64 19 43 EC 22 29 34 1F 50 33 A1 E8 40 03 E3 E7 10 01 AD 01 BF AA DA DD 00 CD AA 9A CD CC 99 99 D9 5A BC 00 12 BD 16 15 08 15 AA 09 E8 A9 40 8C 01 7A DC BD BB CB DB CB 26 BC CB 08 A0 CB CC 00 03 08 C4 DB 00 DA CC CC DC AA 5D 45 DF 00 D8 88 D8 DB D8 88 BC DB 06 88 DD BC DD 8C 0B 5A 02 06 8D 80 09 12 88 D5 DD 55 88 45 55 15 84 88 8D 05 3D 88 00 03 DD 00 03 57 8D 45 5B B7 05 80 BF 10 03 04 08 11 C3 FF 0C C6 06 EF 23 F5 03 FC 03 8E 0B 9F 00 03 15 93 FE 01 84 21 95 40 03 21 A8 30 03 01 7C 11 83 99 25 99 BA 04 87 AA B9 01 6A 9B 00 AE 7C BA 25 39 30 03 1A AD 11 AF 50 3B A5 B9 00 AB AA 44 9B AB AA 5A AA 00 A9 AA 5A B9 A1 AA 5A 99 78 1A 00 0B 00 2A 63 CC 10 09 95 AA AA 21 4A 94 30 03 45 94 AA A9 11 03 3B AA 9A 06 E8 13 DB 00 03 AB 00 8F 20 03 C9 00 53 10 03 44 34 17 9D 44 33 00 02 F8 11 DA 10 03 00 0A 00 13 00 06 34 43 33 41 43 01 F8 91 33 13 91 99 10 12 DE 10 1F 00 02 33 27 D0 10 2F 01 DE 13 CB 44 01 34 93 99 33 93 99 99 01 D7 BF 23 7F 44 11 E3 32 08 99 A9 01 EA 03 AD 77 D3 FC 61 F3 62 23 A0 03 65 FF C5 DC A2 1B 11 A9 00 D9 45 54 99 99 55 55 99 38 99 54 00 03 37 D3 10 ED AA AA 11 42 AA 10 1F 45 45 54 F5 0A 72 F5 80 07 C7 64 55 55 45 54 5A 55 00 55 B5 AA 55 54 A4 9A 45 01 45 A4 99 44 44 A4 DB 01 C3 80 01 AC 4D DA DD DB 44 45 44 01 4B 45 54 55 54 55 4D 00 30 00 BD 49 55 55 AB 99 54 54 00 DD 44 BB AB DB 45 44 AA 0C 54 45 54 BA 00 16 18 2F 45 55 0D 55 54 45 45 0A A5 00 30 54 05 2E 02 99 BB AA 9A B9 A4 05 16 A4 00 99 B9 BB 4A 44 B4 AB 54 00 45 A4 AA 55 94 A9 AA 44 FF 2C 6B 00 1F 00 07 15 2B 01 81 28 76 30 03 5C 85 06 A1 5A 99 A9 A1 00 C3 10 03 91 95 00 03 1A 55 03 15 45 00 03 34 00 E4 04 34 45 44 5A A9 00 68 A9 55 38 54 94 00 03 18 A2 00 0B 55 45 A5 BE 00 0A 94 0B 26 05 8B 03 CB 04 12 30 03 9B AF 20 03 BA 00 70 B9 05 9F 10 01 01 AE 23 6E C3 F0 01 30 01 23 22 FF FF F0 03 70 03 FF F0 31 F0 01 23 D3 00 67 3F BD 30 01 38 F6 70 47 DF 10 11 20 03 F2 00 03 50 1C 00 01 8B 3F 6B 47 CD 2B 65 2C FD 76 67 5D 06 3E 76 76 E0 03 FF BB 98 D0 03 9E C9 80 01 0B 90 3D 6C 00 55 7B 9A FF 90 03 4F 07 10 5F 80 96 10 36 20 35 40 61 30 1E F7 4F 1F 50 03 50 19 20 03 7D 2D BD 00 18 10 2A FE 90 4D 20 01 04 29 20 1F 10 8C 40 40 90 23 7D FF AF 7B 20 7F 20 98 20 B5 8F A0 90 03 D0 67 40 F0 E5 50 CE 50 8E 40 03 B7 BB 00 18 DA 00 03 68 DB 00 03 10 0B B6 40 03 BD 66 66 5A DD 0B FE 8B 00 03 26 46 8A 04 C9 8A C3 0F 76 60 03 D8 BB AB B8 10 03 72 7B C5 26 5F 32 83 BD 9B 99 06 F2 99 0A 96 41 99 D1 7A 86 D8 DD BD F8 1A 7F E4 40 03 81 CB 20 D6 BB AB 00 03 CC AA 2F 6A C8 02 D8 CC 05 B8 11 70 11 AE 10 03 AF 91 A3 6C 00 03 AA 21 A0 61 6F F1 01 21 B5 C0 B1 AF 00 03 DD 66 77 DD 88 66 0C D7 88 88 D6 0D 56 10 35 77 77 16 D7 DD 77 07 BE DD 06 0C 09 E6 D8 EF 0C EB 1B EC 1F 04 D8 10 1B 18 3B 01 0B 20 03 EF 27 C9 07 C6 40 03 8B 19 E7 F0 01 1B 5A 69 B6 9D 0D E1 BB 6B 00 03 27 C3 30 03 BD 0B 69 EE 00 03 00 61 10 F3 D6 00 61 08 3A 00 10 DB EA 18 17 40 7A 2C 13 BD 92 2E 7B 00 03 BB 2E D7 D7 01 7E DB 06 59 30 03 12 44 77 40 D7 00 07 8D B8 8D D7 88 B8 E6 0A A9 0A 40 28 BB 88 BD 10 03 00 2B BD AD 00 27 BD 0A 37 BD 00 0D 0B D9 BB 0B D9 E0 00 03 08 71 00 1E AB D8 BB AD D8 0E 88 BB AD DD 00 0E 0F AC 10 12 8A 2F 88 8D 00 03 8B 40 03 16 C2 00 70 20 03 C3 1A 7B 60 03 DB BB BB B8 00 1C 51 C7 EA 1C 4F 10 EE 00 03 DC 00 0E DC 00 0F DD 47 8F 00 FC DC DD CD 07 07 50 03 09 60 81 09 5C DD DD BC BB DD CD 30 03 02 AB 6A 66 77 AB AA 10 03 6A 96 00 03 AA 76 07 1A 76 06 96 02 07 AA 65 6A 10 03 F4 1E 77 D7 00 03 D6 01 D5 7D D6 02 D2 01 C2 0B 2E 00 67 00 03 8D 10 03 EF 4D 7D 00 88 1E 9D DD 01 CE F1 9D 71 9D 2D 3A 67 8B 07 A7 0B 6C DD BB D0 03 10 1C 60 29 F4 32 17 06 2B 02 02 20 03 8D 01 56 8D B8 7E DD 10 14 4D EC 5F 53 8E 03 11 CA 1D 4D BD FF 92 34 70 03 08 23 20 65 18 29 0D 67 00 85 20 03 FF 00 30 10 03 01 C8 10 42 21 C7 00 7E 00 0B 90 03 8A 08 A0 88 DD 5D 00 1A BA 00 03 DA 82 00 FB 8A 8D D8 AD 88 30 03 8B 87 08 B7 8B 88 55 B5 00 B6 01 C3 01 D3 51 B8 00 03 D8 10 03 D8 BB BA 0C 43 2C BA DB 10 07 BD 00 03 11 D8 DB AB 11 BA B9 BD 0A 52 DD DD AD 00 03 36 DD 9B 18 C0 50 03 88 0B 1B 09 13 DD 9F 09 37 BB BB 00 03 1A 5F 2A 63 4C 34 11 C3 9F 0B 33 BB CB 6A 66 2A 74 5C 4D 18 E3 11 C7 EE 2C 52 50 03 4C 8C 6A 1C 7D 12 FE 00 03 8D 9F 70 03 D6 D8 50 03 12 E2 20 E9 3F 1D 31 53 FF 11 6F 11 EF 11 36 00 69 11 60 0F 92 20 21 1B CB FF 90 01 19 84 31 5D 90 03 01 73 00 EC 10 09 20 10 7E DB 04 E7 00 28 20 03 10 13 00 03 00 D5 DD 43 AB 10 0B BA DB BB DB 01 42 12 04 FF 50 40 29 D9 40 03 10 10 09 FA 31 C7 20 03 12 4B 37 BB 8D 00 0A 02 20 BB 13 7C 13 8C 2E 0A BC 40 03 8D 02 7B 72 92 23 31 51 D2 55 55 09 88 58 55 55 00 02 44 55 14 01 00 8D 88 55 DD 8D 58 55 54 00 B5 88 D8 48 DB 88 BD 55 B2 01 0B 44 00 B9 00 03 8B 55 20 03 BB 2E 88 45 00 03 AB 0A FC 10 EB 00 54 B8 FF 00 4D E0 03 01 04 63 BF 03 B2 20 03 2E 40 10 03 F3 00 14 08 B6 19 30 0D 0A 88 DA 02 D0 10 1D EF 13 DE 02 DC 21 0C DB 02 3D 20 B9 1E EE 00 F2 FF 05 24 30 08 00 59 15 15 1C F1 00 1D 00 F0 02 E3 FB 61 7F 3D 23 01 36 00 44 0E F4 DB 10 29 00 15 9B 10 03 BD DB 00 0B 01 54 BB 00 B0 10 03 EE 18 03 21 09 2E DF BD 00 03 0E F3 23 0D DB A2 20 80 BF 01 99 BD BB DA 01 6F AB 57 DB 01 5D BA 00 68 AD 4D 48 10 7D C1 F1 D5 01 BB 00 03 AD 10 A4 BA 31 A4 BD 0F 09 F8 01 CC 00 EA 01 D5 0F 16 22 F4 BD BD AA F7 02 40 03 C2 00 21 10 65 BD 14 E5 51 1D 11 F6 FF 0C 53 12 0F 01 5A 12 62 45 FB 32 1F 11 F7 80 01 F0 14 66 32 7D F4 07 34 89 58 44 88 88 6A 45 04 8E 20 2C 5D 00 03 4D 80 21 BA 04 44 BA AB 88 5D 00 03 55 BA 12 AB 8D 45 00 03 D4 AB 00 75 AA 3F AA DA 00 C7 14 23 12 33 11 C7 36 13 33 05 FB 20 77 10 E2 20 07 3D DA 07 7B 99 20 03 07 7A 2F 9B DD 10 03 9D 00 03 0D 09 46 28 32 D9 F8 11 F6 45 CF 50 07 05 F4 00 5C B8 DB DB 3F 8D BD 52 22 12 19 60 07 00 F8 32 3F 10 2F D0 00 15 00 07 54 00 0F 4B DD DD 5D 06 45 DD 88 48 54 24 C8 25 30 D4 01 4D BB DD D4 54 B4 4B 0B 1F 00 44 55 34 54 45 55 A3 45 E0 0A A0 20 7F 01 72 B4 AB DD DD A4 01 BA BB DB A3 AA BB DD 00 02 81 01 A7 4D DD 44 DD 4D D4 06 F4 F0 01 A7 42 39 20 06 00 17 D4 4D D4 54 46 44 00 01 45 44 44 22 06 10 43 DB 00 BA DB 4D BD AA BB 4D DD 08 AA BA 45 D4 00 03 A4 AA 8B E4 10 03 11 14 03 3C BB 8D 0F 34 AD D8 2A DD AD 00 4E AD 3F 5F 88 00 07 88 3D AD AD 04 68 18 B0 12 2E 05 F6 B8 15 FA 53 FA 00 03 AA 00 04 AA AA 14 39 01 EB 4A D9 00 BF 9A D9 02 1E 9A 00 29 AA 2D D9 BD 0B D0 B8 00 0C 00 03 AA 63 B8 90 10 01 D8 8D 01 C7 8D 4D D8 DD 00 45 4D DD DD 58 5D D9 55 30 5D 54 25 AA 27 CB BA 8B 88 A8 D7 02 28 02 66 A8 00 AE A4 00 15 10 03 52 1D FB 50 03 F0 01 F0 01 45 7B 44 AB 9B 11 C3 30 03 FF 9B E7 20 17 00 03 41 CB 63 DB 70 01 12 AB 11 BE 97 41 CF AB 8D 00 03 8A 15 9B 22 C2 02 84 D7 10 9D 02 A2 4D 33 4E D8 40 03 03 A6 10 D4 A0 4E C1 54 01 C3 4B 45 44 A4 5B 01 45 34 AA 5B 44 A3 BB 01 73 2C BB 45 03 FB 84 02 0D 14 5B D4 DD 00 54 44 AA DA 54 54 DA BD 10 4B 55 BA 0D 3E BB BB 54 54 00 BB 4B 44 45 BB 5B 55 44 67 BD 0E 25 02 03 54 44 0D 30 02 15 10 4A 6C 44 00 0D 1E 3C 34 1E 40 00 97 93 45 00 44 BA 88 45 34 8B 88 44 00 A3 FB 88 34 BA DD 8F 34 00 8B D8 FB A3 8B 88 BD A9 B4 00 8C B9 35 25 18 94 AA 00 96 AA 88 45 B8 01 8F BD AA AA 03 1F AA 05 C2 D7 0E BF 16 46 8F 21 C7 AA 00 21 20 03 04 B0 B7 00 03 B8 00 0A 24 83 BD 6F 7B 30 03 10 0F C0 30 13 3F 87 9A 5D 54 55 AA D9 80 00 D5 59 45 DA AA 9A A4 BD 1D AA 9A D9 00 14 0E 41 00 03 9A 0D BC 7B A4 05 C0 00 4B 21 1C 00 88 D8 00 5E 50 03 3F B8 BA F1 D0 41 BD 81 84 36 59 59 B0 90 1A FF 19 C6 71 DF 01 D7 00 1B 5B 4B 70 03 01 A0 56 30 9F 04 48 D8 84 22 8B 46 50 30 18 16 45 20 01 DF 02 DB 39 83 FD 20 07 24 33 10 76 05 04 13 FE BF 05 44 BB 06 F7 00 03 90 07 97 17 03 01 17 DA 60 9A 11 56 1F 44 99 AA DA BB BB 1E A4 DD BB 01 50 61 5B 1A 5C 90 7F D8 3D BD 9B 42 3F 11 6F 96 EB 10 7F BD 11 C3 4B A9 03 A0 9B AA 05 70 A9 01 72 00 5C 78 BB 00 58 00 03 06 79 01 D8 BA AA 8A B6 00 69 8D 00 03 00 63 DA 10 03 00 0B BA 83 00 2A A9 BB 99 A9 A9 08 DB 16 47 FF 11 7E 1B 37 B2 E0 28 67 11 C7 88 5F 90 01 18 67 DE 0F 65 10 03 A9 00 6E 30 03 40 10 00 03 9A 70 AA 00 0E 08 82 04 51 AA DA AA A9 BC 1F 9D BA 09 05 00 77 00 9A 00 03 BA 9A DF 01 09 01 93 AB 13 63 07 1C 12 38 06 41 10 02 7F BB 22 4B 10 63 11 C3 48 36 11 4C 70 03 03 72 DE 10 9D 23 AB 9B 10 03 30 54 50 03 4F 9E 99 07 44 DD D8 D8 D4 0A BA 11 88 17 CA FF 05 2A 28 7F 16 7F 01 B5 00 1D 03 AA 18 EC B0 01 DF 44 1B 20 9B AA 03 FF 42 D3 40 03 13 1B 11 BD 16 AA 9A 19 00 CF DB 10 D3 00 FB BA 00 AA 99 91 A9 9A 19 11 99 07 99 19 11 11 99 4F B7 15 74 17 61 FF 21 4D 00 3D 21 F6 00 97 5F D7 46 62 A0 F3 01 46 90 01 41 99 B1 00 1E B9 AA 8A D8 BD 13 9C DD 02 1A 24 4F 48 2E 6A FF 9B 01 63 A0 00 EF AA 02 E6 A9 DD BB 9B A9 D7 12 EF 00 71 99 07 E3 9B 12 3B 1A 44 C1 B6 DF 42 7A 21 A5 99 2A 43 31 CC 02 39 03 90 00 15 EE 00 05 21 BA 00 06 8B 50 0B 20 33 10 13 99 9F 10 4F BA 88 12 38 17 62 2A 89 3E C4 28 2F FD 77 47 30 01 00 36 0B 67 6A 3B 23 0B 8D 42 6B FF 26 FB 01 1A 31 1D 01 C3 47 6C 45 83 10 0B 21 C3 E7 11 DB 70 01 12 66 AA 9A 01 2E 20 C2 05 9C C8 20 3E 02 E8 AB DD 00 CC BD FB FF 28 8F F9 08 F2 9D 08 F7 DA F9 FF 78 8F 01 BA 10 DF 10 C5 00 D7 19 11 BB 00 9B 19 11 B8 BB 99 11 8F AF 00 03 88 00 03 AA 00 13 11 AF 00 02 F0 01 CF 10 01 21 87 99 91 00 09 D0 03 20 01 06 02 C0 09 6F 1E BF 8D 88 99 B9 DD 88 50 99 0F 99 99 00 08 99 11 B1 DD 3F 11 91 00 10 1A BF 40 03 14 2D 44 07 50 03 C0 01 B5 30 D4 9B 99 AA DD 9B DA 29 DD AD 00 F5 8B 07 20 88 D9 0C A8 C0 0A 2A 02 AB BA 88 DD AA 8B 88 FF 07 78 24 17 7D 2E 7D 62 42 12 26 6D 11 7D 48 FB DC 1D 17 00 63 D8 30 73 02 5C 0A 46 AA 8D 4B D8 12 67 BA AB 02 6A BA 23 D7 32 78 A1 33 E9 BA 09 BC FF D8 FB FA 10 03 01 8F B8 FF FA 88 BD FF 84 0B 41 AA 0E C3 AA FF FF 8F AB 01 5E AF 1E 97 B8 0A 58 B8 12 30 23 73 00 CA 00 47 D0 02 1D 55 5B B9 21 B7 AA 9A 88 FD 00 AA AA 89 FD A9 AA 89 88 F4 10 0C 11 BA 02 76 12 7A DD 01 94 BA 88 42 AB 01 8F 9B 11 11 B8 03 11 BB EE 01 84 00 0A 61 8B 1B F1 8D 91 7F 13 43 99 42 11 00 75 91 A9 AA BA 40 03 DB EF 00 80 20 03 00 D9 DD 03 19 07 42 1A 5B 11 0D 22 F8 8F 70 03 FF 8F DD 00 C1 DB 7F 8B 1F 59 01 31 4C 2D 2A 5A 2A 01 3A 67 0B 87 A0 11 50 84 03 68 45 DD DD 85 55 00 DD DD 55 58 DD DD 5B 45 60 D8 00 03 01 71 44 88 DD F8 FF 80 11 63 D8 BD 5B B4 D4 5D 45 40 BB 09 98 BB 55 45 94 AA 54 0B 94 BA DB 44 06 59 BF 09 DE 13 5F FC 06 D7 21 BB 2A AE 20 6F 15 CB 1E 82 BD BB 7F F8 06 4C 28 DE 19 A8 10 03 01 FF 01 3F 10 03 F7 20 01 7C 6B 63 33 13 18 59 00 06 00 03 34 E7 E0 54 F3 63 21 03 C3 A5 9B 99 95 55 1F 9B 59 95 22 F8 23 D8 30 03 17 79 15 B6 96 40 03 99 B9 51 48 1A 80 03 14 BF BA BE 00 03 AA 21 81 E2 F3 90 01 01 72 01 67 DB 50 BD 21 FC A9 00 86 A9 19 BB 19 4B 99 10 03 91 FA 10 03 BB 02 30 10 03 75 FB 30 03 50 01 0C 97 8F 00 03 88 2E 1C F7 27 C6 3B 8B 17 63 0A 55 8A 0A 69 4C 1C 62 E7 75 FD 31 33 21 47 10 1A 9B 0A E7 99 1D 57 B4 8D ED D8 0F C7 57 6F AD 05 F2 AD AA D9 1D 6C 4D 9F FB 00 02 02 CF FF FF 04 A7 AA 14 AB 88 0C 16 88 00 12 BF 20 97 8F 04 BF FF FF DF BD 30 9C 88 88 95 0F FB 88 5B 00 1D 5B 11 63 9F 03 D0 00 FF 99 B9 5B 8F B8 BB 5B AA 14 B3 B5 00 03 55 00 04 45 00 04 55 00 55 59 95 59 45 55 95 95 16 45 54 95 19 86 55 09 88 40 01 54 0F 55 54 45 54 31 76 11 82 B0 03 07 1C D6 01 A8 13 07 1B 01 67 DA 01 47 10 03 BA 0B 11 A9 9A B9 04 72 A9 26 44 26 48 D0 F2 FF 10 03 A9 30 03 91 99 19 99 00 99 8A 19 91 A9 FF 99 99 50 F9 10 03 8F 20 07 9A D9 F8 99 00 DA AD 88 A9 DA AA AD FF E5 03 FB 10 D1 4F C3 AD 88 05 24 D8 0B B4 77 D8 19 E3 15 9C 00 CB 9D 26 14 47 B7 30 9F 5F 55 00 10 5A 18 27 29 C9 04 1B 23 D8 03 54 80 02 3F A5 A5 AA 5A B5 55 A5 27 5A A5 00 EC 54 DB 01 63 19 68 0F 2F 05 AA 55 55 99 AA 01 06 A9 0C 9F 04 99 5A 44 55 95 11 02 BA AB 00 8A 88 55 AB AA 5A 55 DD 00 5A 5A 55 D5 5D D5 45 B5 50 5B 01 1B DD 00 1A BA 45 45 54 7C B5 0F 62 01 4B 10 03 00 71 00 4F 85 5D 80 00 33 B5 55 44 54 55 5B 45 81 00 04 55 44 45 44 55 BB 00 0E 34 B5 5A 00 08 10 12 A5 10 1B 5A 44 C4 00 04 0A EC 55 45 34 01 63 44 5B F8 00 25 10 03 20 2D 0A F8 2B 02 34 44 43 0F 44 34 43 43 45 5F D0 01 21 79 30 ED 97 11 6B B9 1D 06 56 DB 00 DB 17 2B 10 03 7B 1B 13 1A 17 84 F2 F1 A0 01 D1 11 83 16 24 00 11 D1 FF B8 91 FF 8F B8 00 F1 FF DF 9B FD FF BD 99 00 FF D8 9B 99 88 BD 9B A9 F3 0B 4C 05 D9 07 67 00 03 9B A9 11 48 08 7D 38 AD B9 0E 49 29 07 77 8F 5A 55 55 0B 9B AA 55 45 03 CF 5A 23 A5 00 0F BB 01 10 44 00 07 05 79 01 19 AA 00 F4 02 5C F3 00 E1 00 05 10 0A 3B E3 5B 54 01 6D 20 01 D0 02 6C 1D D1 34 00 FE 34 43 54 33 01 34 33 44 33 33 33 33 00 2B D0 11 22 0C 23 34 00 1A 34 43 34 43 7E 44 20 1A 20 1C 10 1F 00 4E 21 36 11 34 34 4A 45 00 1C 53 34 00 16 45 00 03 53 FB 10 1F 11 64 01 53 20 73 11 5C 43 00 73 00 15 5C 34 00 24 43 10 24 2E 44 30 7F 44 54 83 10 91 44 43 34 33 43 40 5C 00 01 F0 20 0D 10 51 F0 01 20 01",
         tilemap2 = "10 00 05 00 31 A2 E0 F0 01 30 01 A3 E0 04 F0 01 81 A0 01 00 00 00 00 A4 E0 F0 01 E1 30 01 F0 3F F0 3F 00 00 A5 E0 F0 01 B1 30 01 A6 F0 31 F0 3F 00 01 D0 F0 01 80 30 01 02 D0 03 D0 A7 D0 A8 00 D0 A9 D0 AA D0 AB D0 AC 00 D0 AD D0 AE D0 AF D0 B0 00 D0 B1 D0 B2 D0 B3 D0 B4 13 D0 B5 D0 10 3F 05 D0 F0 01 10 01 00 06 D0 07 D0 08 D0 B6 D0 00 B7 D0 B8 D0 B9 D0 BA D0 00 BB D0 BC D0 BD D0 BE D0 00 BF D0 C0 D0 C1 D0 C2 D0 10 C3 D0 C4 60 3F 09 D0 0A D0 01 0B D0 0C D0 0D D0 0E 20 3B 00 0F D0 10 D0 11 D0 12 D0 00 13 D0 C5 D0 C6 D0 C7 D0 00 C8 D0 C9 D0 CA D0 CB D0 00 CC D0 CD D0 CE D0 CF D0 01 D0 D0 D1 D0 D2 D0 D3 20 3F 40 14 E0 79 15 D0 16 D0 17 D0 00 18 D0 19 D0 1A D0 D4 D0 00 D5 D0 D6 D0 D7 D0 D8 D0 00 D9 D0 DA D0 DB D0 DC D0 00 DD D0 DE D0 DF D0 E0 D0 11 E1 D0 E2 20 3F 1B D0 1C 40 37 00 1D D0 1E D0 1F D0 20 D0 00 21 D0 22 D0 23 D0 24 D0 00 25 D0 26 D0 E3 D0 E4 D0 00 E5 D0 E6 D0 E7 D0 E8 D0 00 E9 D0 EA D0 EB D0 EC D0 00 ED D0 EE D0 EF D0 F0 D0 44 F1 40 BF 27 D0 28 60 7B 29 D0 00 2A D0 2B D0 2C D0 2D D0 00 2E D0 2F D0 30 D0 F2 D0 00 F3 D0 F4 D0 F5 D0 F6 D0 00 F7 D0 F8 D0 F9 D0 FA D0 00 FB D0 FC D0 FD D0 FE D0 08 FF D0 00 D1 D1 3F 31 D0 32 00 D0 33 D0 34 D0 35 D0 36 00 D0 37 D0 38 D0 39 D0 01 00 D1 02 D1 03 D1 04 D1 05 00 D1 06 D1 07 D1 08 D1 09 00 D1 0A D1 0B D1 0C D1 0D 08 D1 0E D1 0F 20 3F 3A D0 3B 20 D0 3C 00 3B 3D D0 3E D0 3F 00 D0 40 D0 41 D0 42 D0 43 00 D0 44 D0 45 D0 46 D0 47 00 D0 10 D1 11 D1 12 D1 13 00 D1 14 D1 15 D1 16 D1 17 00 D1 18 D1 19 D1 1A D1 1B 02 D1 1C D1 1D D1 1E 20 3F 48 00 D0 49 D0 4A D0 4B D0 4C 00 D0 4D D0 4E D0 4F D0 50 00 D0 51 D0 52 D0 53 D0 54 00 D0 55 D0 56 D0 1F D1 20 00 D1 21 D1 22 D1 23 D1 24 00 D1 25 D1 26 D1 27 D1 28 00 D1 29 D1 2A D1 2B D1 2C 20 D1 2D 20 3F 57 D0 58 D0 59 00 D0 5A D0 5B D0 5C D0 5D 00 D0 5E D0 5F D0 60 D0 61 00 D0 62 D0 63 D0 64 D0 65 00 D0 2E D1 2F D1 30 D1 A4 00 D0 A4 D0 31 D1 32 D1 33 00 D1 34 D1 35 D1 36 D1 37 02 D1 38 D1 39 D1 3A 20 3F 66 00 D0 67 D0 68 D0 69 D0 6A 00 D0 6B D0 6C D0 6D D0 6E 00 D0 6F D0 70 D0 71 D0 72 00 D0 73 D0 74 D0 3B D1 3C 80 20 3D A4 D0 3D D1 3E D1 3F 00 D1 40 D1 41 D1 42 D1 43 02 D1 44 D1 45 D1 46 20 3F 75 00 D0 76 D0 77 D0 78 D0 79 00 D0 7A D0 7B D0 7C D0 7D 00 D0 7E D0 7F D0 80 D0 81 00 D0 82 D0 83 D0 47 D1 48 80 40 3F 49 D1 4A D1 4B D1 4C 00 D1 4D D1 4E D1 4F D1 50 08 D1 51 D1 52 20 3F 84 D0 85 00 D0 86 D0 87 D0 88 D0 89 00 D0 8A D0 8B D0 8C D0 8D 00 D0 8E D0 8F D0 90 D0 91 02 D0 92 D0 53 D1 54 40 3F 55 00 D1 56 D1 57 D1 58 D1 59 00 D1 5A D1 5B D1 5C D1 5D 20 D1 5E 20 3F 93 D0 94 D0 95 00 D0 96 D0 97 D0 98 D0 99 00 D0 9A D0 9B D0 9C D0 9D 00 D0 9E D0 9F D0 A0 D0 A1 08 D0 5F D1 60 20 3F 61 D1 62 00 D1 63 D1 64 D1 65 D1 66 00 D1 67 D1 68 D1 69 D1 6A 3F D1 6B 20 3F F3 95 F0 01 F0 01 73 BF F0 15 FC F0 01 F0 01 F0 3F F0 01 F0 01 F0 3F 00 00",
         palette2 = "FF 03 49 31 BC 7F 08 2E CE 3A 53 4B 39 73 7C 7F 7B 5B AE 2D 32 32 95 3A 19 53 19 53 99 7F 9D 6B FF 2F DE 7F 89 3D 5A 6B 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00";

      // charmander and squirtle
      private readonly static string
         spriteA = "10 00 08 00 3F 00 00 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F8 F0 01 F0 01 F0 01 F0 01 90 01 C0 CC 00 00 B0 AB AA 00 9B 99 AA B0 14 99 99 AA D0 1D 0C 00 03 CA 01 0B 00 00 AA 1A 00 03 AA 00 08 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 C0 F0 01 80 EC A0 99 A9 BA AC AA 20 AA BB 00 03 CB B3 AA AA CA 50 BD 00 03 BE 00 03 9C AA AA BA 11 99 AA AA 00 01 0C 00 CC 00 EC 20 D3 AC 10 03 CA 00 DD AC BA 21 01 EE 00 03 EF AB BA 01 00 36 8A F1 00 00 00 70 F0 12 07 60 09 08 A0 00 1D 87 00 0F 70 08 78 00 70 3F 88 88 F0 29 F0 3C F0 01 F0 01 F0 01 80 E3 D5 40 03 50 01 B0 00 03 9B 00 03 9C 10 17 40 A9 00 E1 BA CA AA BA B1 BB 00 BB CC C0 11 CC BB 0B 00 00 11 C1 9B BB 6C 66 A9 AA 00 6C 66 AA AA 5B 55 AA CA 00 BB 01 1C BC CB 00 B3 BB 01 1B 00 BB BC 1B 00 CC 00 27 05 BB BB BB AB B6 00 03 65 00 08 81 80 55 70 C0 9B 0C 00 AC 00 03 94 11 33 AA BA 02 1F 1B 01 0C 87 88 00 07 00 77 88 78 00 77 87 04 78 77 78 77 77 00 03 87 87 10 88 78 87 00 FB 78 70 87 77 7F 78 90 F7 90 FB D0 0F F0 01 F0 01 F0 01 F0 01 81 D0 01 CC CA 55 55 00 CC 00 03 00 C0 44 55 00 6B 44 54 00 00 4C 44 44 00 41 44 44 C0 00 41 44 45 AB 41 54 54 95 80 00 E3 55 BB BB 11 55 B6 BB 54 1B 20 03 B5 20 03 BB 20 03 C6 AA 3C BB 1B 02 01 D2 04 10 0F 00 FA BC 1B 00 CC BC AA 00 87 BB 77 00 50 B0 00 03 C0 01 2A 9C B9 00 C0 00 99 0B 00 9C 99 01 00 AA 5F C9 01 1F CA F0 E3 F0 01 F0 01 F0 01 F0 01 F0 C1 EF 10 03 D2 07 22 1B AA 5C 45 45 41 AA 01 03 AA CA 56 55 AB 01 F7 00 BC BB 1B 66 C0 BB BB C1 00 BC BB BB 1B AB BA BB 01 04 55 AB AA AA 55 03 1C 65 A1 01 AA AA 66 B1 AA BB 66 02 28 28 66 C6 01 10 11 11 FB C1 BB BB 10 BC BB AB 00 03 BB BB B1 BB 00 6B BB B1 6B 16 BB 61 C6 09 01 BB 11 01 10 FF 00 BB 04 2C FF 02 0A 20 0B F3 28 F0 01 F0 01 F0 01 F0 01 F0 01 B9 C0 01 3C F0 F7 80 1C 02 D3 11 11 14 D5 D4 F0 01 30 01 AC 05 03 31 00 43 C0 11 87 F0 1B 00 00 BA 0B 00 43 00 DC F0 42 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 F0 01 F0 01 F0 01 D0 01",
         paletteA = "10 20 00 00 00 39 57 42 08 D6 5A FF 7F 00 9F 4F 5F 37 BC 2E 9E 01 00 9F 06 1F 33 5F 22 3B 25 00 13 0D 23 19 88 3E 32 6F",
         spriteB = "10 00 08 00 3F 00 00 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 EA F0 01 F0 01 A0 01 E0 00 03 CE 30 03 E0 00 D1 00 00 F0 C9 00 D0 DD 00 EE D0 BD BB CC BD BB BB 20 CB BB 20 03 CB CD BC BB DC 04 EB CC CC BC 9E 00 03 1E 0E A4 00 2C EC 00 04 CC EC 00 03 CC 0E 88 00 03 EC 00 CE 00 03 D5 CC DC 07 0E 1A CE DD 0F F0 62 F0 01 F0 01 FC F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 CF A8 00 03 CA 40 F3 CC 30 03 F0 EF 00 40 EE 00 0F BE EE F0 CC CC CC 51 FF 40 03 F9 00 03 CC CD CE 10 05 00 ED FE FA FF AA AA AC AA 02 88 E8 1F DE DD 0F 10 03 C9 08 DD DD 0F DC 10 03 DE FD 44 00 FF DD FD 21 DA FE 1F 21 08 FD BB EF 25 F0 6F 00 00 04 AF 00 03 42 00 03 32 10 08 F0 01 F0 01 F0 01 F0 F0 01 F0 01 F0 01 F0 01 00 F0 CE FC 00 EE BF CC BC DE F0 CC FC 00 DF 00 FF DD DD 00 00 FE 60 DF 42 07 20 01 FF CD CC DD CC 00 FF FF 8E DD 84 88 88 DD 00 3D 33 33 DD 74 37 77 FF 00 7F 36 66 00 7F 86 66 00 00 3F 66 68 FF FD CB 2E F8 00 DD CE FD EE DD DD FD BF 80 01 00 F7 EF DD DD 76 F7 DD 00 FD 76 37 FF FF 66 93 88 02 F8 42 43 00 00 34 00 03 33 00 33 04 00 3F 33 04 D0 3F 00 33 0F BE 55 33 FF CC 11 01 44 DF CC 11 33 DF CD 90 8B 50 ED 02 47 CB 52 47 DC 0F 00 EE 3F DE ED F0 B0 F0 01 F0 01 F0 01 F0 01 F0 01 C0 F0 01 21 20 83 83 00 F0 67 68 00 00 E0 7F 97 00 CE 8F 38 00 E0 CC FC 88 E0 CC DC 8F 00 F0 CD DD FD 00 DF DD DD 00 38 73 88 F8 66 37 83 88 00 77 88 33 EE 88 88 E8 DD 00 83 88 DE CC 33 83 CF CC 00 8F 38 DF CC FE FF DF DD 80 00 E3 ED 54 45 DD ED 5F 45 01 DD FD ED DF DD FD DD 00 33 14 DC FD DD 01 2D DD 02 26 FF 00 07 CD FC FD 00 DC 00 4A 00 10 00 03 0F 0F 00 EF FE 01 81 03 35 F3 38 F0 01 FE F0 01 F0 01 F0 01 F0 01 F0 01 80 01 00 AF F0 01 EC DC DD E0 FF FF FF F0 1C 82 10 A7 D0 DD 0E 00 F0 02 37 F0 E4 14 37 E0 23 00 D6 00 ED 00 D3 CE CE 0F 0F 00 FF FF 14 2D F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 70 01",
         paletteB = "10 20 00 00 00 39 57 FF 7F 5A 2A B7 01 00 AC 00 3A 67 9F 4F 5F 37 00 BC 2E 1A 1E D9 0C 76 77 00 11 6B 50 56 C8 31 42 08";

      public ViewPort ViewPort { get; set;  }

      private void SetupTilemaps() {
         var delta = new ModelDelta();
         var data = (0x5000 * 6).Range().Select(i => (byte)0xFF).ToArray();
         Insert(data, 0x20, tileset1);
         Insert(data, 0x05000, tilemap1);
         Insert(data, 0x0A000, palette1);
         Insert(data, 0x0F000, tileset2);
         Insert(data, 0x14000, tilemap2);
         Insert(data, 0x19000, palette2);

         var model = new PokemonModel(data, null, BaseViewModelTestClass.Singletons);
         model.WritePointer(delta, 0x00, 0x20);
         model.WritePointer(delta, 0x04, 0x05000);
         model.WritePointer(delta, 0x08, 0x0A000);
         model.WritePointer(delta, 0x10, 0x0F000);
         model.WritePointer(delta, 0x14, 0x14000);
         model.WritePointer(delta, 0x18, 0x19000);

         using (ModelCacheScope.CreateScope(model)) {
            PokemonModel.ApplyAnchor(model, new ModelDelta(), 0, "^table1[tileset<`lzt4|table1`> tilemap<`lzm4x32x20|table1`> pal<`ucp4:DE`> unused::]2");
         }

         ViewPort = new ViewPort(string.Empty, model, InstantDispatch.Instance, BaseViewModelTestClass.Singletons) { Width = 16, Height = 16 };
      }

      private void SetupSprites() {
         var delta = new ModelDelta();
         var data = (0x5000 * 4).Range().Select(i => (byte)0xFF).ToArray();
         Insert(data, 0x20, spriteA);
         Insert(data, 0x05000, paletteA);
         Insert(data, 0x0A000, spriteB);
         Insert(data, 0x0F000, paletteB);

         var model = new PokemonModel(data, null, BaseViewModelTestClass.Singletons);
         model.WritePointer(delta, 0x00, 0x20);
         model.WritePointer(delta, 0x04, 0x05000);
         model.WritePointer(delta, 0x08, 0x0A000);
         model.WritePointer(delta, 0x0C, 0x0F000);

         using (ModelCacheScope.CreateScope(model)) {
            PokemonModel.ApplyAnchor(model, new ModelDelta(), 0, "^table1[sprite<`lzs4x8x8|table1`> pal<`ucp4`>]2");
         }

         ViewPort = new ViewPort(string.Empty, model, InstantDispatch.Instance, BaseViewModelTestClass.Singletons) { Width = 16, Height = 16 };
      }

      [Fact]
      public void ProperSetupTest() {
         // verifies that the data actually made it to the model as we expect
         SetupTilemaps();
         Assert.Equal(0x32, ViewPort.Model[0x0024]);
         Assert.Equal(0x31, ViewPort.Model[0x5004]);
         Assert.Equal(0x93, ViewPort.Model[0xA004]);
      }

      [Fact]
      public void ImportImage1OverImage2ResultsInCorrectData() {
         SetupTilemaps();
         short[] pixelData = null;
         int width = 0;
         var fs = new StubFileSystem {
            SaveImage = (p, w, n) => (pixelData, width) = (p, w),
            LoadImage = fileName => (pixelData, width),
         };

         ViewPort.SelectionStart = new Point(4, 0);
         ViewPort.FollowLink(4, 0);                 // jump to the tilemap, which should load image1 in the sprite tool
         ViewPort.Tools.SpriteTool.ExportPair.Execute(fs);

         ViewPort.Goto.Execute("00");
         ViewPort.SelectionStart = new Point(4, 1);
         ViewPort.FollowLink(4, 1);                 // jump to the tilemap, which should load image1 in the sprite tool
         ViewPort.Tools.SpriteTool.ImportPair.Execute(fs);

         // the compression and color ordering may be different
         // but the rendered image should be the same
         var importedPixelData = ViewPort.Tools.SpriteTool.PixelData;
         Assert.Equal(pixelData.Length, importedPixelData.Length);
         for (int i = 0; i < pixelData.Length; i++) {
            Assert.Equal(pixelData[i], importedPixelData[i]);
         }
      }

      [Fact]
      public void ImportSpriteAOverSpriteBResultsInCorrectData() {
         SetupSprites();
         short[] pixelData = null;
         int width = 0;
         var fs = new StubFileSystem {
            SaveImage = (p, w, n) => (pixelData, width) = (p, w),
            LoadImage = fileName => (pixelData, width),
         };

         ViewPort.SelectionStart = new Point(2, 0);
         ViewPort.FollowLink(2, 0);                 // jump to the tilemap, which should load image1 in the sprite tool
         ViewPort.Tools.SpriteTool.ExportPair.Execute(fs);

         ViewPort.Goto.Execute("00");
         ViewPort.SelectionStart = new Point(8, 0);
         ViewPort.FollowLink(8, 0);                 // jump to the tilemap, which should load image1 in the sprite tool
         ViewPort.Tools.SpriteTool.ImportPair.Execute(fs);


         // the compression and color ordering may be different
         // but the rendered image should be the same
         var importedPixelData = ViewPort.Tools.SpriteTool.PixelData;
         Assert.Equal(pixelData.Length, importedPixelData.Length);
         for (int i = 0; i < pixelData.Length; i++) {
            Assert.Equal(pixelData[i], importedPixelData[i]);
         }
      }

      [Fact]
      public void CautiousImportCreatesCorrectImage() {
         SetupTilemaps();
         short[] pixelData = null;
         int width = 0;
         var fs = new StubFileSystem {
            SaveImage = (p, w, n) => (pixelData, width) = (p, w),
            LoadImage = fileName => (pixelData, width),
            ShowOptions = (_0, _1, _d, _2) => 2, // use Cautious
         };

         ViewPort.Edit("@table1/1/pal <A000>"); // alter tilemap2 to use the same palette as tilemap1
         var spritesForPalette = ((IPaletteRun)ViewPort.Model.GetNextRun(0xA000)).FindDependentSprites(ViewPort.Model);
         Assert.Equal(2, spritesForPalette.Count);

         ViewPort.SelectionStart = new Point(4, 0);
         ViewPort.FollowLink(4, 0);                 // jump to the tilemap, which should load image1 in the sprite tool
         ViewPort.Tools.SpriteTool.ExportPair.Execute(fs);

         ViewPort.Goto.Execute("00");
         ViewPort.SelectionStart = new Point(4, 1);
         ViewPort.FollowLink(4, 1);                 // jump to the tilemap, which should load image1 in the sprite tool
         ViewPort.Tools.SpriteTool.ImportPair.Execute(fs);

         // the compression and color ordering may be different
         // but the rendered image should be the same
         var importedPixelData = ViewPort.Tools.SpriteTool.PixelData;
         Assert.Equal(pixelData.Length, importedPixelData.Length);
         for (int i = 0; i < pixelData.Length; i++) {
            Assert.Equal(pixelData[i], importedPixelData[i]);
         }
      }

      [Fact]
      public void ReorderPaletteDoesNotEffectRenderSprite() {
         SetupTilemaps();
         ViewPort.SelectionStart = new Point(4, 0);
         var spriteTool = (SpriteElementViewModel)ViewPort.Tools.TableTool.Children.Single(child => child is SpriteElementViewModel sevm && sevm.PixelWidth == 256);
         var palTool = (PaletteElementViewModel)ViewPort.Tools.TableTool.Children.Single(child => child is PaletteElementViewModel pevm);
         var copy = spriteTool.PixelData.ToList();

         // swap to colors in the palette, which forcing the tileset to re-index
         // note that tiles that don't use this palette _shouldn't_ re-index
         palTool.Colors.SelectionStart = 1;
         palTool.Colors.HandleMove(1, 0);
         palTool.Colors.CompleteCurrentInteraction();

         // the compression and color ordering may be different
         // but the rendered image should be the same
         Assert.Equal(copy.Count, spriteTool.PixelData.Length);
         int x = -1;
         for (int i = 0; i < copy.Count; i++) {
            x = (x + 1) % 256;
            if (x >= 240) continue; // don't verify the last 2 rows: they're filled with '00' tiles, which are transparent, so the color doesn't matter
            Assert.Equal(copy[i], spriteTool.PixelData[i]);
         }
      }

      string compressedBattleBackgroundTiles = "10 80 0A 00 30 00 00 F0 01 90 01 11 11 11 11 30 FF FF 70 01 40 0F 4F FF FF 34 50 33 00 02 33 C0 1F 44 11 44 33 50 33 00 01 63 30 03 65 22 11 44 00 44 14 4F 99 99 42 94 99 40 99 20 01 56 99 96 99 66 66 02 99 22 66 66 55 55 00 02 35 82 10 3F F4 4F 44 33 32 00 30 29 80 00 03 99 53 65 66 22 53 22 10 22 33 33 10 03 26 22 11 F1 30 FF FF 20 51 20 01 55 65 22 22 8C B0 01 FF 44 44 30 71 00 01 66 66 3D 66 66 D0 1F 00 1E F0 1F F0 1F 93 10 7A 12 66 66 56 00 5F 55 55 30 03 52 98 00 03 22 52 40 B6 40 01 69 55 66 00 66 36 63 33 66 33 96 35 A0 00 4E 55 00 03 99 46 1F 11 99 50 69 00 3C 36 30 63 99 36 25 22 8C 30 03 22 22 36 00 C7 10 DF 33 44 44 F4 60 C3 66 56 35 00 D9 22 62 F7 50 7F 51 3F 00 22 10 23 43 20 23 00 58 00 1A 79 56 90 1F 10 01 00 22 00 23 44 11 10 23 8E 00 7F 33 22 56 E1 7F 21 9F 20 27 43 AB 10 2B 43 51 AF 34 21 AF 4F 00 2F 01 B3 D6 00 06 10 3F 53 00 0A 63 00 03 10 01 26 C0 11 6B 00 02 22 63 22 22 99 26 0D 22 62 99 22 01 A1 00 7E 66 91 70 89 00 14 22 99 39 00 03 36 23 10 7A 03 22 55 33 63 22 62 01 C3 00 E9 E0 10 AF F0 01 00 01 33 33 25 22 53 7F 55 00 58 F0 01 F0 01 F0 01 10 01 61 2B F0 01 B2 00 79 25 F0 13 B0 01 92 29 10 B1 22 3F 62 56 00 A3 F1 FF 51 67 F0 46 30 F2 11 93 7F 62 11 6B 00 04 00 8A 10 E7 01 D9 B1 BF 01 6A D6 41 6F 11 E7 43 11 9F F4 11 5F 02 12 43 F7 11 63 10 0B 11 73 23 2F 41 00 07 11 8B 21 93 3E FF FF 50 47 11 21 01 7B 21 83 21 8B 33 30 33 56 11 9B B0 8D 99 99 52 53 2E 95 99 00 4F 96 43 63 A0 1F 21 9F 69 17 22 22 59 01 6F 55 10 03 E3 2D B1 18 B3 00 03 96 F0 16 41 31 99 23 00 4B F1 D6 BB B0 6E 92 00 6D F0 01 50 01 23 F0 12 D0 01 FA F0 7F 90 60 00 87 F0 01 50 77 66 02 77 62 9D 01 CF 99 99 02 AE 14 50 01 C7 66 13 B3 EB 20 77 03 7A 11 53 56 02 AE 22 02 AE 14 4F 7F 62 02 AE 01 BB 01 C3 01 CB 11 D3 11 DB 11 A3 E1 11 9F 11 B3 13 2F 33 33 14 11 11 CB FF 11 D3 23 4F 01 84 41 AF 04 F3 64 FF 60 01 74 9B EE 00 27 04 49 00 1E 41 90 1F 11 83 31 D3 55 76 66 10 23 11 D3 00 4A 44 50 1F 30 C3 22 5E 62 11 FF 33 04 FB 60 4B 05 13 10 1F 66 1F 35 33 23 04 32 63 40 15 03 60 23 20 3F F3 51 07 30 01 14 E3 70 8F 44 44 41 07 60 01 EE 90 1F 14 FB 00 12 95 00 3F 00 A5 14 EF 56 E8 04 DF 04 7C 70 1F FF 02 72 29 99 56 3C 33 53 70 15 80 EF 82 BF 00 67 62 33 7A 55 14 95 50 3C 14 85 60 1F 56 80 56 43 F1 40 1A 30 1F 04 48 70 35 44 FF 14 E1 5F FF 03 4F 01 8C 50 32 F4 EF F0 0F F0 0F F0 0F 30 01 3F 4F 44 F0 1F 40 0F 01 7F 10 91 F0 1F 30 0F FB 50 B1 F0 1F 00 0F 86 73 F0 1F 11 07 12 F0 1F A0 80 1F 91 00 06 99 33 44 99 99 08 33 93 99 99 D0 1F 99 19 11 5E 11 01 93 36 16 8C 16 91 F0 3F 30 0F F3 FF 40 03 F0 1F 60 0F 26 13 80 0F 27 D3 12 EF 96 13 E7 22 CF 60 AD 13 27 65 22 02 2C 14 3B 22 B7 F5 40 2B 17 9B 26 2B 14 83 69 03 6F 35 02 10 6F 66 22 F7 10 35 65 10 0A F4 7F 25 5F F4 A5 FF 10 01 13 FA 15 68 F7 B3 C5 BC 37 2B F0 01 53 2F 45 96 18 73 99 99 55 08 76 55 28 72 E4 00 6F 00 34 40 5E 22 69 04 37 69 66 8F 12 F7 35 33 66 04 0C 00 06 40 E7 36 11 79 34 17 BF 02 97 91 01 00 E4 56 92 00 E4 7F 66 00 E4 51 3F 87 73 15 FF 66 33 F1 7F 30 0F 81 56 33 BB BB BB BB DD DD 70 01 90 10 1F EE EE 70 01 88 88 88 88 E4 10 23 50 01 10 0F CC CC 70 01 AA AA FE F0 01 90 01 10 43 50 07 10 5F 10 07 90 8F AE FD C0 23 D0 3F F0 7F B0 0F F0 DF 00 0F 4F 03 E1 1E 96 99 46 01 7A F2 9F 58 EF 00 03 69 80 01 34";
      string compressedBattleBackgroundTilemap = "10 00 10 00 3D 4D 20 F0 01 F0 01 F0 01 50 01 4C F0 01 EF F0 01 F0 01 60 01 50 F0 01 F0 01 F0 01 60 01 7B 4E F0 01 F0 01 F0 01 60 01 4F F0 01 F0 01 DC F0 01 60 01 36 F0 01 F0 01 60 01 52 20 70 53 F0 15 F0 01 60 01 01 20 02 20 00 03 20 04 20 05 20 06 20 00 07 20 08 20 09 20 0A 20 01 0B 20 0C 20 0D 20 0E F0 2D 80 E0 01 0F 20 10 20 11 20 12 08 20 13 20 14 40 01 15 20 16 80 00 05 17 20 18 20 19 20 1A C0 F0 31 C0 01 1B 20 1C 20 1D 20 00 1E 20 1F 20 20 20 21 20 44 22 00 39 23 20 24 00 05 25 20 06 26 20 27 20 28 F0 31 E0 01 29 00 20 2A 20 2B 20 2C 20 2D 00 20 2E 20 2F 20 07 28 30 00 20 31 20 32 20 33 20 34 3F 20 35 F0 2D F0 01 F0 01 F0 01 F0 01 F0 01 D0 F0 01 70 01 30 10 01 37 30 38 30 04 39 30 3A 30 3B 00 01 3A 34 01 39 30 3C 30 3D 30 3E 20 19 C0 F0 31 B0 01 3F 30 40 30 41 30 01 42 30 43 30 44 30 45 40 01 00 46 30 47 30 48 30 49 30 19 4A 30 4B F0 3F C0 01 00 00 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 B0 01 3F 51 20 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F7 D1 F0 01 F0 01 F7 FF F0 01 F0 01 F0 01 FF F7 FF F0 01 F0 01 F7 FF F0 01 F0 01 F0 01 F7 FF FF F0 01 F0 01 F7 FF F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F7 FF F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F7 FF F0 01 F0 01 F0 01 F0 01 E0 F0 01 F0 01 B0 01";
      [Fact]
      public void CanRecompressWell() {
         var tileData = LZRun.Decompress(Parse(compressedBattleBackgroundTiles), 0);
         var mapData = LZRun.Decompress(Parse(compressedBattleBackgroundTilemap), 0);

         var originalTiles = SplitTiles(tileData);
         var pixels = LzTilemapRun.GetPixels(mapData, tileData, new TilemapFormat(4, 32, 64, default), 2);
         var tileInfo = LzTilemapRun.Tilize(pixels, 4);
         var newTiles = LzTilemapRun.GetUniqueTiles(tileInfo, true);

         foreach (var tile in newTiles) {
            foreach (var pixel in tile) Assert.InRange(pixel, 0, 15);
            var (index, matchType) = LzTilemapRun.FindMatch(tile, originalTiles, true);
            Assert.NotEqual(TileMatchType.None, matchType);
         }

         Assert.InRange(newTiles.Count, 3, originalTiles.Length);
      }

      // titlescreen pokemon data
      private readonly static string
         titlescreenPalette1 = "00 7C 00 00 2A 5B 1F 7C 1F 7C 1F 7C 04 00 06 00 08 00 0B 00 8F 00 93 00 D6 00 19 01 7B 01 FC 01 ",
         titlescreenTileset1 = "10 E0 10 00 3C 00 00 F0 01 F0 01 F0 01 20 01 B0 BB 60 BB F0 14 20 01 BB 00 BB BB DD 08 BB DD DD BD 30 0D 0B 00 B0 00 EE BE BB B0 EE EE EE DB 20 DD DD 00 15 BB BB BD AB 77 50 77 00 02 77 70 30 00 00 EE BB ED 00 34 00 1E 00 06 BB 00 1A 10 01 87 70 51 02 0A 00 BB DD AB 0A 00 1C AB 82 40 1F BB 78 77 77 B7 F0 7A 00 2E 00 0A 00 03 AB 30 32 F0 1C B0 01 66 D0 F0 12 70 01 06 10 04 EB EE EE 00 84 00 B4 00 A0 AA AA F0 21 00 00 60 DE 00 AE 00 CE AB AA BA BB 7B 02 A0 AA BB 7B 00 A0 00 03 00 40 DA 60 03 7A 77 87 88 77 77 38 88 88 00 06 70 03 00 0F 87 78 87 4D 88 00 19 88 88 F0 01 D0 01 68 F0 12 A0 70 01 B7 01 38 66 BB AB 00 88 00 B6 BB 0A 88 68 B7 AB 88 01 88 76 BB 88 88 78 B7 00 1A B1 10 5C 78 F1 1B 71 1B B7 AB 01 F1 CF D0 00 EF 11 A7 EB 00 D8 EA DD DB DD C0 90 1D 01 C5 DB BD B0 DB DD EE 1C DE DD BD 11 A7 10 01 51 BC BB DD 00 AA 00 DD DD AA AA DD 8B 00 EE DA A9 66 FF AE AD 6A 08 F6 DF DD AD 21 33 B6 00 00 20 60 9B 00 06 B9 AA 60 99 88 00 DD 88 89 88 DD DD 88 88 41 DA 00 3B DA AA AA AA 69 00 20 54 9B 01 68 99 00 03 98 00 0C 88 98 2A 06 00 00 B7 08 00 1E 8A 00 1E DA D4 F1 71 30 01 88 00 03 DD 10 04 00 DA 6A AD 00 03 02 67 DA 00 8B A0 40 03 00 C1 10 37 10 03 A0 87 88 68 87 11 7E 81 00 03 67 7B 87 88 78 7D 01 7F 53 BD 00 03 DD 00 10 DD 7B 71 47 00 12 2A 88 76 00 03 67 00 08 78 50 08 68 9E 10 15 88 78 40 03 F0 01 11 64 01 48 77 00 BA AB 00 77 A7 BB 0A 78 01 77 BA 0B 78 77 A7 AB 00 6D 47 BA 00 03 B7 88 78 F2 9F A1 83 00 03 5A D8 01 63 D8 11 0B 00 03 D0 02 DC DA 80 02 4A FA AA 8A 88 D0 8F B8 1A DD 00 6A 23 2D 60 01 BF 03 1D FF 00 B9 BB BB FF A9 AA BA BD 1A 9B 99 99 13 49 02 7E AA 00 03 AB B0 03 53 AB 43 1B 00 03 AB AA 99 99 06 AA AA BB BB 89 01 42 20 01 BB 0B AA AA BA 8B 00 03 88 00 0B 50 03 D9 11 5F 20 01 8B F0 D6 60 01 AA 8A 01 6B 00 88 88 00 88 99 99 88 98 00 99 9B 99 98 B9 B9 99 99 7A 9B 00 7C 40 07 11 63 50 D7 08 41 97 88 EB 00 08 00 32 20 03 DD 01 70 DA 10 03 01 74 56 A0 01 74 A0 01 74 00 00 10 03 1A 87 1D 00 90 BB 01 85 11 6C 22 E2 86 40 08 58 89 40 03 99 40 03 10 06 99 98 99 77 99 20 01 10 07 10 03 89 40 0C 30 1D E0 01 B3 10 1E 08 00 06 00 83 78 77 00 25 00 03 27 89 88 00 02 88 89 00 9B 10 A7 84 56 8A 03 07 00 00 68 01 8C 88 10 0C BA 6C 0B 00 D1 00 10 A0 20 0C A4 41 D0 0D EE 30 03 00 05 50 04 FF 02 6E 04 1B 13 07 DA D7 10 34 12 EF A8 00 03 80 10 26 12 88 51 BB A1 01 66 DB 21 6C BA BB BB B8 01 3E 3B 90 09 30 53 01 B7 61 BF AA 00 02 21 AC EC 01 AD 01 BF 11 79 08 51 A3 D0 01 88 A8 02 AA AA 80 A7 AA AA 12 A1 7A D0 11 A7 00 08 AA 00 08 AA 7A 87 88 24 AA AB 00 03 BA 6A 01 E3 AB 86 B6 41 0B 89 21 2A 50 03 98 11 5E 50 01 08 FB 01 23 10 03 01 E3 00 08 00 03 07 91 FF 11 A3 A5 00 03 7A 20 03 00 B9 00 03 B8 00 03 5B B0 20 0B 08 00 03 00 22 98 C0 03 A0 01 E7 A1 AC 30 8A C1 C6 08 00 01 A6 F0 03 01 A4 F2 10 03 01 53 F5 C5 A0 01 D0 FD 00 04 F0 F6 40 03 21 72 51 A0 10 01 DF 21 83 21 87 D0 A7 41 8A FD 50 04 D0 DF 34 BF 11 AB 51 AF 47 FF 00 08 FF DD 00 20 1F 10 03 40 46 68 80 80 03 A0 2F B8 03 62 9B 9B B8 06 AA BA 99 B8 AB 02 60 05 88 89 96 02 49 98 B8 00 2A B9 00 1E 03 A9 BA 5F 79 01 87 9A 91 BB 11 E5 01 E2 21 EE 54 7B 40 79 01 7B 9A 87 88 00 AA 79 94 00 03 9A 77 01 F7 69 11 FB 66 08 3D 00 80 23 52 50 7B 00 01 02 63 AA 32 73 C8 00 03 01 83 77 88 01 A3 98 B9 7A 00 77 B9 BD 7A 87 DD AA 77 2B 87 AD 06 74 AA 07 3B 7A 00 03 F3 D1 FF 30 4C 53 03 51 90 10 01 01 BE 03 CF 20 6F 60 01 BD 11 83 98 40 03 13 3B 10 03 A0 20 FF 01 47 F7 10 03 11 2B 00 04 01 68 FD 20 07 10 03 01 87 D6 A4 C0 20 01 FF 01 75 FD 10 03 00 35 DD EF 01 6A 71 B4 60 03 07 00 03 01 60 10 03 43 4F FF 14 63 64 67 A8 68 48 0F 10 01 03 5A E0 03 01 43 EA 21 7B 61 73 21 77 8A 00 03 B8 00 1D DB 00 BD 08 00 D9 AB 8A 00 B9 0A AA AA 08 A9 00 29 A9 05 35 A9 00 99 88 AA 9A 88 AB A8 AA 56 99 00 26 99 01 43 07 08 6B 10 03 00 85 00 0B 00 79 77 07 20 03 88 00 03 3F 99 79 00 A8 B0 BA 62 77 50 01 F0 FF 00 D5 C1 87 55 50 E7 DD AD 0A 00 D6 07 30 3D A0 DA 09 33 00 04 00 EE 16 BF 70 C0 4E 14 A0 AA 0A 06 EC AB 04 32 DD 7B 50 DD 08 6E AD F0 F3 BB FA BA DB 00 AE FF BA EE EE AD DA EE 23 EE DE 09 51 BD BB B9 10 03 00 1C 80 00 03 9F 97 BB BB DF 9D 88 00 A8 DD AD B9 8A D9 AB AA 00 8A BB AA A8 99 BB AA 98 9D 00 03 8A 99 00 0E 00 FF 10 03 98 60 03 13 99 99 68 02 23 89 06 10 08 92 2B D7 50 01 D9 2F 68 00 03 89 17 CF 00 08 00 36 C0 69 DF B0 01 70 77 70 77 97 99 67 97 C0 3F 30 19 77 07 80 5E A2 6A 99 B4 71 99 00 59 07 7D 21 12 00 00 FA 03 E6 48 FA 05 8B AA FF 08 06 AA 00 DA 04 D9 AA 00 FA 9D 00 03 FF AA 00 67 9A A9 A7 DD D9 7D 79 00 9D FD DF 7A 9A FF DD 7A 08 9A DF AD 7A 02 02 97 A7 AA 01 77 7A 7A 97 A9 AA EA 08 EB 80 00 03 DE EA EE DE 9D EA EE 00 DD DF EA DE FA DF EA EE 14 AD AA E7 30 17 EE 01 23 E8 D9 0F BD AA 8A DD 02 40 12 3B 40 01 10 9B 90 00 1D EE EE 11 2F A8 88 B8 98 0F 88 DD BB 8A 01 6A 05 DE 35 C3 01 3C 07 88 EE 89 88 EE 91 2B 54 F4 46 CB EF 04 2E 02 64 21 56 78 11 5A 16 A3 00 03 20 0C 0F 68 98 99 89 10 18 23 95 18 BE D0 01 5F 76 00 03 68 00 03 F0 1D B0 01 20 1E 40 04 FA 10 0E D0 1F 11 4F 12 C5 1A 28 78 00 08 77 9A 01 BB 77 67 00 03 00 08 77 10 08 90 30 79 A7 F2 87 70 01 9A 79 A9 AA 1E 07 00 77 16 F7 90 27 02 BB 19 87 DA 4A DD 41 5F EE AA 00 03 A9 00 03 AD 99 00 03 DD EC 00 03 00 14 DD CD 21 42 EB F0 01 F0 01 50 01 9E 00 03 AE 40 4A 00 03 10 DE A9 9E 07 07 AE AA CC AC 00 A9 CA CC CC AA CC CC CC C8 00 06 A0 03 AA 9A 19 09 99 99 AC BA 00 08 BC 00 08 17 5A 01 A2 9A 40 03 AA 08 89 96 C9 CC 11 6D 99 89 86 A0 02 E3 76 01 73 68 87 99 99 69 E0 01 87 30 03 00 42 9C 99 99 C9 CC AB 01 08 C9 00 D7 90 52 E3 87 11 27 00 08 A4 11 43 9C 00 03 CC 79 30 03 C0 9C 0A 77 87 90 9C 05 92 CC 10 03 67 AD 01 6F 67 10 23 06 10 03 08 8A 06 01 85 7A 67 90 03 2A B7 58 43 A0 03 CC 00 73 CA 0C CC DD CD EC 01 27 02 99 CD DC 80 00 03 AC ED DD CC AA CA CD 3C CC AA 00 F1 00 03 02 67 21 15 DD DD 69 ED 0B AE 60 01 CC 00 03 9A C9 00 03 1B 99 C9 DC 11 23 00 20 A9 00 12 90 03 02 9C DD DD CD 9C CD 31 23 BC CD 01 37 30 03 CA CC 01 1E 15 33 BA 22 EA FF 05 11 26 A3 40 03 31 33 05 25 00 0E 15 53 01 57 8C 01 5C 99 89 76 00 04 F0 03 99 79 B9 21 3F 77 01 28 02 A9 01 07 87 99 01 03 60 98 1D D3 92 7F 90 CC 96 99 CC 06 6C 99 99 66 96 F2 EC 22 BF 78 1B 77 67 89 01 44 0D EB 67 51 47 30 03 EA 11 57 01 3E 23 FF 90 12 7F A9 00 07 99 40 A0 0C 73 FA FA DF AA AA FF 02 9F A9 A0 AA DA FD 87 76 99 42 A9 00 AF AA 99 89 66 50 0F AF B8 00 BE 9A 03 84 1A 17 00 79 78 88 66 1C 66 67 66 00 5C 03 86 00 03 67 66 F9 19 17 01 22 20 01 09 59 00 63 88 88 11 FF E9 25 F5 40 01 11 23 9C 10 4D 8A 9A 57 3F 5E 98 87 AB 00 12 7B 11 25 AA 9B 0A 8A 98 B4 00 18 A8 21 3F 12 67 76 20 03 89 79 12 67 77 98 20 0F 89 76 00 22 68 0F 89 87 78 DF F3 D1 B4 03 F0 01 60 01 0F 66 77 67 66 43 C7 00 03 13 D3 00 BC EF 11 31 2E D7 76 52 FF 4A B7 F0 01 19 3F 00 D5 6E 8A F5 85 90 01 90 40 03 F0 01 10 FF FD 00 8A 98 AA FF 7F 97 A9 FF 0C 6F 66 90 FD 0A F4 C5 F1 FD 7D 00 F7 FF FF DF 67 FF FD FF 0E 09 99 90 F9 00 1F 5B 18 40 01 6D 0F 66 66 66 9F 00 07 B0 15 86 0B B0 CC 80 E0 01 ",
         titlescreenTilemap1 = "10 00 05 00 3F 00 D0 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 FF F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 F0 01 C0 F0 01 90 01 01 D0 02 D0 03 D0 07 04 D0 05 D0 06 F0 1D F0 01 A0 01 00 07 D0 08 D0 09 D0 0A D0 00 0B D0 0C D0 0D D0 0E D0 70 0F F0 23 F0 01 20 01 10 D0 11 D0 00 12 D0 13 D0 14 D0 15 D0 04 16 D0 17 D0 18 00 41 19 D0 1C 1A D0 1B F0 2B F0 01 00 01 1C D0 00 1D D0 1E D0 1F D0 20 D0 00 21 D0 22 D0 23 D0 24 D0 01 25 D0 26 D0 27 D0 28 F0 2B 80 F0 01 D0 29 D0 2A D0 2B D0 00 2C D0 2D D0 2E D0 2F D0 00 30 D0 31 D0 32 D0 33 D0 58 34 00 19 35 F0 2D F0 01 D0 36 D0 00 37 D0 38 D0 39 D0 3A D0 00 3B D0 3C D0 3D D0 3E D0 07 3F D0 40 D0 41 F0 29 F0 01 40 01 00 42 D0 43 D0 44 D0 45 D0 01 46 D0 47 D0 48 D0 49 F0 21 C0 F0 01 A0 01 4A D0 4B D0 4C D0 00 4D D0 4E D0 4F D0 50 D0 00 51 D0 52 D0 53 D0 54 D0 70 55 F0 29 F0 01 60 01 56 D0 57 D0 00 58 D0 59 D0 5A D0 5B D0 00 5C D0 5D D0 5E D0 5F D0 70 60 F0 27 F0 01 40 01 61 D0 62 D0 00 63 D0 64 D0 65 D0 66 D0 00 67 D0 68 D0 69 D0 6A D0 70 6B F0 27 F0 01 60 01 6C D0 6D D0 00 6E D0 6F D0 70 D0 71 D0 01 72 D0 73 D0 74 D0 75 F0 25 C0 F0 01 60 01 76 D0 77 D0 78 D0 00 79 D0 7A D0 7B D0 7C D0 07 7D D0 7E D0 7F F0 25 F0 01 60 01 10 80 D0 81 20 07 82 D0 83 D0 07 84 D0 85 D0 86 F0 23 F0 01 F0 01 80 E0 01 ";
      private readonly static short[] titlescreenImage2Data = 40960.Range().Select(i => (short)(i % 0x10)).ToArray();
      private readonly static int titlescreenImage2Width = 256;

      [Fact]
      public void TilemapWithPaletteOffset_Import_NewDataRespectsPaletteOffset() {
         var data = (0x5000 * 4).Range().Select(i => (byte)0xFF).ToArray();
         var model = new PokemonModel(data, null, BaseViewModelTestClass.Singletons);
         ViewPort = new ViewPort(string.Empty, model, InstantDispatch.Instance, BaseViewModelTestClass.Singletons) { Width = 16, Height = 16 };
         ViewPort.Edit("@2000 " + titlescreenPalette1);
         ViewPort.Edit("@4000 " + titlescreenTileset1);
         ViewPort.Edit("@6000 " + titlescreenTilemap1);
         ViewPort.Edit("@2000 ^palette`ucp4:D` @4000 ^tileset`lzt4|palette` @6000 ^tilemap`lzm4x32x20|tileset` ");

         ViewPort.Tools.SelectedTool = ViewPort.Tools.SpriteTool;
         ViewPort.Tools.SpriteTool.SpriteAddress = 0x6000;
         ViewPort.Tools.SpriteTool.ImportPair.Execute(new StubFileSystem { LoadImage = arg => (titlescreenImage2Data, titlescreenImage2Width) });

         var run = model.GetNextRun(model.GetAddressFromAnchor(ViewPort.CurrentChange, -1, "tilemap")) as LZRun;
         var uncompressedData = LZRun.Decompress(model, run.Start);
         Assert.Equal(0xD0, uncompressedData[1]);
      }

      private static byte[] Parse(string data) => data.Split(' ').Select(s => byte.Parse(s, NumberStyles.HexNumber)).ToArray();

      private static void Insert(byte[] result, int index, string data) {
         var input = Parse(data);
         Array.Copy(input, 0, result, index, input.Length);
      }

      private static int[][,] SplitTiles(byte[] data) {
         var tiles = new List<int[,]>();
         for (int i = 0; i < data.Length; i += 32) {
            tiles.Add(SpriteRun.GetPixels(data, i, 1, 1, 4));
         }
         return tiles.ToArray();
      }

      public static string TextRender(int[,] tile) {
         var builder = new StringBuilder();
         for (int y = 0; y < 8; y++) {
            for (int x = 0; x < 8; x++) {
               builder.Append(ViewPort.AllHexCharacters[tile[x, y]]);
            }
            builder.AppendLine();
         }
         return builder.ToString();
      }
   }
}
